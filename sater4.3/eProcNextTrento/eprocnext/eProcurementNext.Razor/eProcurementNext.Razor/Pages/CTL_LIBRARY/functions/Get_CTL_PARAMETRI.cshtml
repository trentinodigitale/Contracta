@page "/CTL_LIBRARY/functions/Get_CTL_PARAMETRI.asp"
@inject eProcurementNext.Session.ISession session;
@using eProcurementNext.CommonDB
@using eProcurementNext.CommonModule;
@using static eProcurementNext.CommonModule.Basic;
@using eProcurementNext.BizDB;
@using eProcurementNext.HTML;
@using eProcurementNext.Application;
@using static eProcurementNext.HTML.BasicFunction;
@using Microsoft.VisualBasic;
@using static eProcurementNext.Razor.Pages.CTL_LIBRARY.functions.verificaBrowserModel;
@using static eProcurementNext.Razor.Pages.CTL_LIBRARY.functions.securityModel;
@using static eProcurementNext.Razor.Pages.CTL_LIBRARY.DOCUMENT.CommonModel;
@model eProcurementNext.Razor.Pages.CTL_LIBRARY.functions.Get_CTL_PARAMETRIModel
@using static eProcurementNext.Session.SessionMiddleware
@{
	LoadSession(HttpContext, session);
	EprocResponse htmlToReturn = new(GetParamURL(HttpContext.Request.QueryString.ToString(), "XML_ATTACH_TYPE"));
}
@{
	//'-------------------------------------
	//'-- VALIDAZIONE DELL'INPUT UTENTE  ---
	//'-------------------------------------
	//on error goto 0

	string Contesto = GetParamURL(Request.QueryString.ToString(), "Contesto");
	string Oggetto = GetParamURL(Request.QueryString.ToString(), "Oggetto");
	string Prop = GetParamURL(Request.QueryString.ToString(), "Prop");
	string DefValue = GetParamURL(Request.QueryString.ToString(), "DefValue");
	int  Idpfu = CInt(GetParamURL(Request.QueryString.ToString(),"Idpfu"));

	validate( "Contesto", Contesto , TIPO_PARAMETRO_STRING, SOTTO_TIPO_PARAMETRO_PAROLASINGOLA, "", 1,HttpContext,session);
	validate("Oggetto", Oggetto.Replace(" ", ""), TIPO_PARAMETRO_STRING, SOTTO_TIPO_PARAMETRO_PAROLASINGOLA, "", 1, HttpContext, session);
	validate("Prop", Prop, TIPO_PARAMETRO_STRING, SOTTO_TIPO_PARAMETRO_PAROLASINGOLA, "", 1, HttpContext, session);
	validate("DefValue", DefValue, TIPO_PARAMETRO_STRING, SOTTO_TIPO_PARAMETRO_PAROLASINGOLA, "", 1, HttpContext, session);
	validate("Idpfu", CStr(Idpfu), TIPO_PARAMETRO_INT, SOTTO_TIPO_VUOTO, "", 1, HttpContext, session);

	htmlToReturn.Write($"1#{Get_Func_Property(Contesto, Oggetto, Prop, DefValue, Idpfu)}");
	throw new ResponseEndException(htmlToReturn.Out(), Response, "");
}@Html.Raw(htmlToReturn.Out())