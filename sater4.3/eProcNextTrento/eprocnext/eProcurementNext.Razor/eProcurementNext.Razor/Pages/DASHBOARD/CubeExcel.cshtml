@page "/DASHBOARD/CubeExcel.asp"
@using eProcurementNext.DashBoard
@using eProcurementNext.CommonModule
@using Microsoft.VisualBasic
@* <!-- #Include File="../CTL_Library/Functions/intestexcel.inc" --> *@
@using static eProcurementNext.Razor.Pages.CTL_LIBRARY.functions.intestModel 
@using static eProcurementNext.CommonModule.Basic;
@inject eProcurementNext.Session.ISession session;
@model eProcurementNext.Razor.Pages.DASHBOARD.CubeExcelModel
@using static eProcurementNext.Session.SessionMiddleware
@{
	LoadSession(HttpContext, session);
	EprocResponse htmlToReturn = new EprocResponse(GetParamURL(HttpContext.Request.QueryString.ToString(), "XML_ATTACH_TYPE"));
}
@{
	string strfilename = "List.xls";
	Response.ContentType = "application/x-msexcel";
	Response.Headers.Add("Content-Disposition", "attachment; filename=" + strfilename);
	
	StartPage(htmlToReturn);
	
	CubeGrid cube= new CubeGrid(HttpContext, session, htmlToReturn);
	cube.run(htmlToReturn);
	


}@Html.Raw(htmlToReturn.Out())