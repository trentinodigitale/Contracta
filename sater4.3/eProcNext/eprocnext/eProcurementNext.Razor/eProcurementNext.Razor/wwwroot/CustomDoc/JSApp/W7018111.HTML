<html>
<head>
<meta http-equiv="content-type" content="text/html">
<meta name="generator" content="PSPad editor, www.pspad.com">
<title>javascript preview: W7018111.HTML</title>
</head>
<body>
<script type="text/javascript">
<!-- begin script
var LstAttrib = [

'NomeRapLeg',
'CognomeRapLeg',
'LocalitaRapLeg',
'ProvinciaRapLeg',

];


var NumControlli = LstAttrib.length;

function trim(str){
    return str.replace(/^\s+|\s+$/g,"");
}


function LocDMessageBox( path , Text , Title , ICO , w , h)
{
    alert( CNV( '../../' , Text ) );
}

function InvioOfferta( param )
{

    //alert(param);
    var bret = false;
    var bret=ControlliOfferta('');
    //alert(bret);
    if ( ! bret ){
        return;
    }

    ExecDocProcess( 'SEND,OFFERTA');

}

function GeneraPDF ()
{
	var value2=controlli('');
	if (value2 == -1)
	    return;

    Stato = getObjValue('StatoDoc');
    
    if( Stato == '' ) 
    {
        //alert( 'Per effettuare la stampa si richiede prima un salvataggio. Verra\' effettuato in automatico, successivamente effettuare nuovamente il comando di stampa');
		LocDMessageBox( '../' , 'Per procedere si richiede prima un salvataggio, successivamente effettuare nuovamente il comando genera pdf.' , 'Attenzione' , 1 , 400 , 300 );
        MySaveDoc();
        return;
	}
    scroll(0,0);
    
//	ReplaceSepClasseIscriz('ClasseIscriz');
//	ReplaceSepClasseIscriz('SettoriCCNL');
    
    PrintPdfSign('URL=/report/prn_OFFERTA.ASP?SIGN=YES');
	
	//RefreshDocument('./');
	
}

function TogliFirma () 
{
	LocDMessageBox( '../' , 'Si stanno per eliminare tutti i file firmati.' , 'Attenzione' , 1 , 400 , 300 );
	ExecDocProcess( 'SIGN_ERASE,MULTI_SIGN');
}
function TogliFirmaTEC () 
{
	LocDMessageBox( '../' , 'Si stanno per eliminare tutti i file firmati.' , 'Attenzione' , 1 , 400 , 300 );
	ExecDocProcess( 'SIGN_ERASE,MULTI_SIGN');
}

function SetInitField()
{
    
	var i = 0;
	for( i = 0 ; i < NumControlli ; i++ )
	{
		TxtOK( LstAttrib[i] );
	}
   
    
} 
function TxtErr( field )
{
	
    if ( field != 'DichiaraTipoImpresa' )
    {
		try{ getObj(field ).style.backgroundColor='#FFBE7D'; }catch(e){}; // F80
		//try{ getObj( field  ).style.borderColor='#F00'; }catch(e){};
		
		try{ getObj(field + '_V' ).style.backgroundColor='#FFBE7D'; }catch(e){}; //FFC
		//try{ getObj( field  + '_V' ).style.borderColor='#F00'; }catch(e){};
		
		
		try{ getObj(field + '_edit' ).style.backgroundColor='#FFBE7D'; }catch(e){};
		try{ getObj(field + '_edit' ).style.backgroundColor='#FFBE7D'; }catch(e){};
		//try{ getObj( field  + '_edit1' ).style.borderColor='#F00'; }catch(e){};
		
		
  		if ( getObj(field  ).type == 'checkbox' )
  		{
    		try{ getObj(field  ).offsetParent.style.backgroundColor='#FFBE7D'; }catch(e){};
    		//try{ getObj( field  ).offsetParent.style.borderColor='#F00'; }catch(e){};
    		
		}
	}
	else
	{
        try{ getObj(field  )[0].offsetParent.style.backgroundColor='#FFBE7D'; }catch(e){};
        try{ getObj(field  )[1].offsetParent.style.backgroundColor='#FFBE7D'; }catch(e){};
        try{ getObj(field  )[2].offsetParent.style.backgroundColor='#FFBE7D'; }catch(e){};
		
	}
	
	
}    

function TxtOK( field )
{
    if ( field != 'DichiaraTipoImpresa' )
    {
		
		try{ getObj( field ).style.backgroundColor='#FFF'; }catch(e){};
		//try{ getObj( field  ).style.borderColor='lightgrey'; }catch(e){};
		
		try{ getObj( field  + '_V' ).style.backgroundColor='#FFF'; }catch(e){};
		//try{ getObj( field  + '_V' ).style.borderColor='lightgrey'; }catch(e){};
		
		try{ getObj( field  + '_edit' ).style.backgroundColor='#FFF'; }catch(e){};
		//try{ getObj( field  + '_edit1' ).style.borderColor='lightgrey'; }catch(e){};
		
        try{
			if ( getObj(field  ).type == 'checkbox' )
			{
				//try{ getObj( field  ).offsetParent.style.borderColor='#FFF'; }catch(e){};
				try{ getObj(field  ).offsetParent.style.backgroundColor='#F4F4F4'; }catch(e){};
			}
		}catch( e ) {alert( field);}
    	
	}
    else
    {
        try{ getObj(field  )[0].offsetParent.style.backgroundColor='#FFF'; }catch(e){};
        try{ getObj(field  )[1].offsetParent.style.backgroundColor='#FFF'; }catch(e){};
        try{ getObj(field  )[2].offsetParent.style.backgroundColor='#FFF'; }catch(e){};
	}
}



function IsNumeric2(sText)
{
	var ValidChars = '0123456789.';
	var IsNumber=true;
	var Char;
	
	for (i = 0; i < sText.length && IsNumber == true; i++) 
	{ 
		Char = sText.charAt(i);
		if (ValidChars.indexOf(Char) == -1) 
		{
			IsNumber = false;
		}
	}
	return IsNumber;
	
}


function roundTo(X , decimalpositions)
{
    var i = X * Math.pow(10,decimalpositions);
    i = Math.round(i);
    return i / Math.pow(10,decimalpositions);
}

function OFFDettagliDel( x , y , z ) 
{

    if( getObjValue ( 'R' + y + '_NotEditable' ) == '' )
    {
        return DettagliDel( x , y , z );
    }
}   

function GeneraPDF_ECO()
{

    //chiamata ai controlli del documento
    var bret = false;
    var bret=ControlliOfferta('');
    if ( ! bret ){
      return;
    }
    
    LocalPrintPdf( '/report/OFFERTA_PRODOTTI.asp?BUSTA=BUSTA_ECONOMICA%26&PAGEORIENTATION=landscape&TO_SIGN=YES&TABLE_SIGN=CTL_DOC_SIGN&IDENTITY_SIGN=idHeader&PDF_NAME=BustaEconomica&AREA_SIGN=F1' );
}

function GeneraPDF_TEC()
{

    //chiamata ai controlli del documento
    var bret = false;
    var bret=ControlliOfferta('');
    if ( ! bret ){
      return;
    }
    
    LocalPrintPdf( '/report/OFFERTA_PRODOTTI.asp?BUSTA=BUSTA_TECNICA%26&PAGEORIENTATION=landscape&TO_SIGN=YES&TABLE_SIGN=CTL_DOC_SIGN&IDENTITY_SIGN=idHeader&PDF_NAME=BustaTecnica&AREA_SIGN=F3' );
}

function GeneraPDF_FID()
{
    //chiamata ai controlli del documento
    var bret = false;
    var bret=ControlliOfferta('');
    if ( ! bret ){
      return;
    }
      
    LocalPrintPdf( '/report/OFFERTA_CAUZIONE.asp?&TO_SIGN=YES&TABLE_SIGN=CTL_DOC_SIGN&IDENTITY_SIGN=idHeader&PDF_NAME=Fideiussione&AREA_SIGN=F2' );
}

function LocalPrintPdf( param )
{

    //if( SP_NumTotRow == 0 )
    if( PRODOTTIGrid_NumRow == -1 )
    {
		LocDMessageBox( '../' , 'Per creare il PDF e\' necessario aver compilato la sezione prodotti' , 'Attenzione' , 1 , 400 , 300 );
        return;
    }
    
    
    if( getObjValue('RTESTATA_PRODOTTI_MODEL_EsitoRiga') != '' )
    {
		LocDMessageBox( '../' , 'Per creare il PDF e\' necessario aver compilato la sezione prodotti senza errori' , 'Attenzione' , 1 , 400 , 300 );
        return;
    }
    
    
    Stato = getObjValue('StatoDoc');

    if( Stato == '' ) 
    {
		LocDMessageBox( '../' , 'Per effettuare la stampa si richiede prima un salvataggio. Verra\' effettuato in automatico, successivamente effettuare nuovamente il comando di stampa.' , 'Attenzione' , 1 , 400 , 300 );
        MySaveDoc();
        return;
	}
    
    PrintPdf( param );
}

function HideProdotti()
{
	
	if ( getObjValue( 'RichiediProdotti' ) == '0' )
	{
		
		document.getElementById('PRODOTTI').style.display = "none";	
	}
	
	
}

//funzione per inserire nella sezione documentazione i tipi allegati consentiti scelti in creazione del BANDO
function FormatAllegato()
{
    
	var numDocu = GetProperty( getObj('DOCUMENTAZIONEGrid') , 'numrow');
	var tipofile;
	var richiestaFirma;
	var onclick;
	var obj;
	
	for( i = 0 ; i <= numDocu ; i++ )
	{
		try
		{
		    
			tipofile=getObj('RDOCUMENTAZIONEGrid_' + i + '_TipoFile').value;
			
			try
			{
				richiestaFirma=getObj('RDOCUMENTAZIONEGrid_' + i + '_RichiediFirma').value;
			}
			catch(e)
			{
				richiestaFirma='';
			}
			
			tipofile=ReplaceExtended(tipofile,'###',',');
			tipofile='INTEXT:'+tipofile.substring(1,tipofile.length);
			tipofile=tipofile.substring(0, tipofile.length-1)+'-';
			tipofile='FORMAT='+tipofile;

			if ( richiestaFirma == '1' )
			{
				tipofile = tipofile + 'VB'; //format per forzare la verifica di firma bloccante in caso di mancata firma o file corrotto
			}

			obj=getObj('RDOCUMENTAZIONEGrid_' + i + '_Allegato_V_BTN' ).parentElement;
			onclick=obj.innerHTML;
			onclick=onclick.replace('FORMAT=INT',tipofile);
			obj.innerHTML = onclick;
			
		}
		catch(e){}
	}
	
}



function MyExecDocProcess(param){
	
	ExecDocProcess(param);
}

function MySaveDoc(){
	
	SaveDoc();
	
}





function Doc_DettagliDel( grid , r , c )
{
	var v = '0';
	try
	{
		v = getObj( 'RDOCUMENTAZIONEGrid_' + r + '_Obbligatorio' ).value ;
		}catch(e){};
	
    if( v == '1' )
    {
        //DMessageBox( '../' , 'La documentazione è obbligatoria' , 'Attenzione' , 1 , 400 , 300 );
	}
    else
    {
        DettagliDel( grid , r , c );
	}
}

function DOCUMENTAZIONE_AFTER_COMMAND ()
{
	HideCestinodoc();
	FormatAllegato();
	
}
function HideCestinodoc()
{
    try{
        var i = 0;
		
		if (getObj('StatoDoc').value== 'Saved' || getObj('StatoDoc').value == ''  )
		{
			for( i=0; i < DOCUMENTAZIONEGrid_EndRow+1 ; i++ )
			{
				if( getObj( 'RDOCUMENTAZIONEGrid_' + i + '_Obbligatorio' ) . value == '1' )
				{
					getObj( 'DOCUMENTAZIONEGrid_r' + i + '_c0' ).innerHTML = '&nbsp;';
				}
			}
		}
	}catch(e){}
	
}


function OnClickProdotti( obj )
{
	var Stato = '';
	Stato = getObjValue('StatoDoc');

	if( Stato == '' ) 
    {
		LocDMessageBox( '../' , 'Prima di procedere con l\'importazione dei prodotti è necessario effettuare un salvataggio del documento' , 'Attenzione' , 1 , 400 , 300 );
	}
	else
	{

        if( getObjValue( 'FIRMA_IN_CORSO' ) == '1' )
        {
            LocDMessageBox( '../' , 'L\'operazione di caricamento file offerte togliera\' tutte le firme attualmente inserite' , 'Attenzione' , 1 , 400 , 300 );
            
        }
	
	
        var DOCUMENT_READONLY = getObj( 'DOCUMENT_READONLY' ).value;
        if ( DOCUMENT_READONLY == "1" )
            DMessageBox( '../' , 'Documento in sola lettura' , 'Attenzione' , 1 , 400 , 300 );
        else
		    ImportExcel( 'CAPTION_ROW=yes&TITLE=Upload Excel&TABLE=CTL_Import&FIELD=RTESTATA_PRODOTTI_MODEL_Allegato&SHEET=0&PARAM=posizionale&PROCESS=LOAD_PRODOTTI,ISTANZA_SDA_FARMACI&OWNER_FIELD=Idpfu&OPERATION=INSERT#new#400,300' );
	}
    
	
}


function RefreshContent()
{
    RefreshDocument('');

      
}


function FIRMA_ECONOMICA_OnLoad()
{

    DisplaySection();

    try 
    {
        
	    if ( getObjValue('RichiestaFirma') == 'no')
	    {
		    document.getElementById('DIV_FIRMA_ECO').style.display = "none";
		    return;	
	    }
        FieldToSign( 'F1' );
    }catch( e ) {};
}

function FIRMA_TECNICA_OnLoad()
{


    try 
    {
        
	    if ( getObjValue('RichiestaFirma') == 'no')
	    {
		    document.getElementById('DIV_FIRMA_TEC').style.display = "none";
		    return;	
	    }
        FieldToSign( 'F3' );
    }catch( e ) {};
}


function FIRMA_FIDEUSSIONE_OnLoad()
{
    try 
    {

	    if ( getObjValue('RichiestaFirma') == 'no'  || getObjValue('ClausolaFideiussoria') != '1' )
	    {
		    document.getElementById('DIV_FIRMA_FID').style.display = "none";
	    }
	    else
	    {    	
            FieldToSign( 'F2' );
        }
        FormatAllegato();

    }catch( e ) {};
     
}

function FieldToSign( Field )
{

    var Stato ='';
	Stato = getObjValue('StatoDoc');
	
	if ((getObjValue(Field + '_SIGN_LOCK') =='0' || getObjValue(Field + '_SIGN_LOCK') =='')   && (Stato=='Saved' || Stato==""))
    {
		document.getElementById(Field + '_generapdf').disabled = false; 
		document.getElementById(Field + '_generapdf').className ="generapdf";
	}
	else
	{
		document.getElementById(Field + '_generapdf').disabled = true; 
		document.getElementById(Field + '_generapdf').className ="generapdfdisabled";
	}
	
	
	if ( ( getObjValue(Field + '_SIGN_LOCK') != '0' && getObjValue(Field + '_SIGN_LOCK') != '' )  && (Stato=='Saved') )
    {
		document.getElementById(Field + '_editistanza').disabled = false; 
		document.getElementById(Field + '_editistanza').className ="attachpdf";
	}
	else
	{
		document.getElementById(Field + '_editistanza').disabled = true; 
		document.getElementById(Field + '_editistanza').className ="attachpdfdisabled";
	}
	 
	if (getObjValue(Field + '_SIGN_ATTACH') == ''  &&  (Stato=='Saved') && ( getObjValue(Field + '_SIGN_LOCK') != '0'  && getObjValue(Field + '_SIGN_LOCK') != '') )
    {
		document.getElementById(Field + '_attachpdf').disabled = false; 
		document.getElementById(Field + '_attachpdf').className ="editistanza";
	}
	else
	{
		document.getElementById(Field + '_attachpdf').disabled = true; 
		document.getElementById(Field + '_attachpdf').className ="editistanzadisabled";
	}
	
}


function DownLoadCSV()
{

    var TipoBando = getObjValue( 'TipoBando' );
    var LinkedDoc = getObjValue( 'LinkedDoc' );
    //var DocBANDO = getObjValue( 'JumpCheck' );
    var DocBANDO = getObjValue( 'TipoDocBando' );
    if( DocBANDO == '' ) DocBANDO = 'BANDO_SEMPLIFICATO'
    
    ExecFunction('../../Report/CSV_LOTTI.asp?IDDOC=' + LinkedDoc + '&TIPODOC=' + DocBANDO + '&MODEL=MODELLI_LOTTI_' + TipoBando + '_MOD_OffertaINPUT' );
    
}
window.onload=DisplaySection;

function DisplaySection( obj )
{
    
    var crit = getObjValue( 'CriterioAggiudicazioneGara' );
    var conf = getObjValue( 'Conformita' );
    var Divisione_lotti = getObjValue( 'Divisione_lotti' );
    
    
    //-- se è privista la conformita Ex-Ante oppure è economicamente più vantaggiosa
    //if( ( conf == 'Ex-Ante' || crit == '15532' ) && Divisione_lotti != '0' )
    if ( Divisione_lotti != '0' )
    {
        DocDisplayFolder(  'BUSTA_ECONOMICA'   ,'none' );
        DocDisplayFolder(  'LISTA_LOTTI' ,'' );
        
         //se non ho la parte tecnica nascondo la colonan della busta tecnica
       if ( conf != 'Ex-Ante' && crit != '15532' )
          ShowCol( 'LISTA_BUSTE' , 'Esito_Busta_Tec' , 'none' );
        
    }
    else
    {
        DocDisplayFolder(  'BUSTA_ECONOMICA'   ,'' );
        DocDisplayFolder(  'LISTA_LOTTI' ,'none' );
    }
    
    //-- a fronte di un bando di Ristretta le sole buste presenti saranno copertina e documentazione
    try
    {
        if(  getObjValue( 'ProceduraGara' ) == '15477' &&  getObjValue( 'TipoBandoGara' ) == '2' )
        {
            
            DocDisplayFolder(  'BUSTA_ECONOMICA' ,'none' );
            DocDisplayFolder(  'LISTA_LOTTI'     ,'none' );
            DocDisplayFolder(  'PRODOTTI'        ,'none' );
        }
        
    }catch( e ) {};
    

    
   HideShowAreeRTI();
    
    
}


function OpenEconomica(objGrid , Row , c) 
{
    var cod = getObj( 'RLISTA_BUSTEGrid_' + Row + '_id').value;

    ShowDocumentPath( 'OFFERTA_BUSTA_ECO' , cod ,'../');
    
}

function OpenTecnica(objGrid , Row , c) 
{
    var cod = getObj( 'RLISTA_BUSTEGrid_' + Row + '_id').value;

    ShowDocumentPath( 'OFFERTA_BUSTA_TEC' , cod ,'../');
    
}

function DownloadZipBuste()
{
	var IDDOC=getObjValue( 'IDDOC' ) ;
	ExecFunctionCenter('/Application/CTL_LIBRARY/pdf/genera_buste.asp?ID_OFFERTA=' + IDDOC + '#DownloadZip#480,360');
}

function UploadBusteFirmate()
{
	var IDDOC=getObjValue( 'IDDOC' ) ;
	ExecFunctionCenter('/Application/ctl_Library/functions/FIELD/UploadAttach.asp?PAGE=../../pdf/importaBusteFirmate.asp&ID_OFFERTA=' + IDDOC + '#UploadZip#480,360');
}



//nasconde le griglie secondo i campi settati si/no per le RTI
function HideShowAreeRTI(){
    
    
    //alert('HideShowAreeRTI');
    
    //se settata RTI disabilito la possibilità di cancellare la prima riga
    if ( getObj('PartecipaFormaRTI').value == '1' ){
      	  
      
      try{
        getObj('RTIGRIDGrid_r0_c1').onclick = '';  
        try{getObjGrid('RRTIGRIDGrid_0_FNZ_DEL').style.display='none';}catch(e){}
      }catch(e){}
  	  
  	}else{
  	   
      //nascondo area relativa
  	  getObj('div_RTIGRIDGrid').style.display='none';
      try{getObj('OFFERTA_PARTECIPANTI_RTI_TOOLBAR_ADDNEW').style.display='none';}catch(e){}
  	}
  	   
    
    //se non settata CONSORZIO nascondo area relativa
  	if ( getObj('InserisciEsecutriciLavori').value == '1' ){
  	  
  	  getObj('div_ESECUTRICIGRIDGrid').style.display='';
      try{getObj('OFFERTA_PARTECIPANTI_ESECUTRICI_TOOLBAR_ADDFROM').style.display='';}catch(e){}
  	  
  	}else{
  	   
      //nascondo area relativa
  	  getObj('div_ESECUTRICIGRIDGrid').style.display='none';
      try{getObj('OFFERTA_PARTECIPANTI_ESECUTRICI_TOOLBAR_ADDFROM').style.display='none';}catch(e){}
  	  
  	}
  	
  	
  	//se settata RTI disabilito la possibilità di cancellare la prima riga
  	if ( getObj('RicorriAvvalimento').value == '1' ){
  	  
      getObj('div_AUSILIARIEGRIDGrid').style.display='';
      try{getObj('OFFERTA_PARTECIPANTI_AUSILIARIE_TOOLBAR_ADDFROM').style.display='';}catch(e){}
  	  
  	}else{
  	   
      //nascondo area relativa
  	  getObj('div_AUSILIARIEGRIDGrid').style.display='none';
      try{getObj('OFFERTA_PARTECIPANTI_AUSILIARIE_TOOLBAR_ADDFROM').style.display='none';}catch(e){}
  	}
  	
  	try{
    	//setto onchange sulla colonna codice fiscale
      SetOnChangeOnCodiceFiscale('RTIGRIDGrid');
      SetOnChangeOnCodiceFiscale('ESECUTRICIGRIDGrid');
      SetOnChangeOnCodiceFiscale('AUSILIARIEGRIDGrid');
    }catch(e){}
    
}


//cancella tutte le righe di una griglia
function MyDelete_RTIGrid( grid , obj ) {
  
  if ( obj.value == '0'  ){
    
    if (  confirm( CNV ('../../' , 'Sei sicuro di cancellare ' + grid ) ) == true) {
        
         var sec = getObj( grid + '_SECTION_DETTAGLI_NAME' ).value;
  
         ExecDocCommand( sec + '#DELETE_ALL#' );
	       
         //ShowLoading( sec );
	      
    }else
      obj.value = '1' ;
      
  }else{
    
    //se sono sulla griglia RTI è vuota allora inserisco in automatico prima riga con azienda loggata
    if ( grid == 'RTIGRIDGrid' && obj.value == '1' ){
      
      //recupero azienda fornitore che ha fatto il documento
      var Azienda = getObj('Azienda').value ;
      
      var sec = getObj( grid + '_SECTION_DETTAGLI_NAME' ).value;
      
      var Param = 'IDROW=' + Azienda + '&TABLEFROMADD=Seleziona_Fornitore_RTI';
      //alert(Param);
      ExecDocCommand( sec + '#ADDFROM#' + Param );
	       
      //ShowLoading( sec );
      
    }
      
    
  }
  
  
  HideShowAreeRTI();
  
  
}



//viene eseguita dopo i comandio sulla griglia RTI
function RTIGRID_AFTER_COMMAND( command ){
    
    
    //alert(command);
    if ( command == 'DELETE_ALL'){
      
      //se ho cancellato la griglia nascondo area relativa
      getObj('div_RTIGRIDGrid').style.display='none';
      getObj('OFFERTA_PARTECIPANTI_RTI_TOOLBAR_ADDNEW').style.display='none';
    
    }else{
      
      getObj('div_RTIGRIDGrid').style.display='';
      getObj('OFFERTA_PARTECIPANTI_RTI_TOOLBAR_ADDNEW').style.display='';
    
    }
    
    
    var NumRowRti = GetProperty(getObj('RTIGRIDGrid'),'numrow');
    
    if (NumRowRti != -1){
      //alert( GetProperty ( getObjGrid('val_RRTIGRIDGrid_0_Ruolo_Impresa'), 'value'));
      //se è la prima riga
      if ( GetProperty ( getObjGrid('val_RRTIGRIDGrid_0_Ruolo_Impresa'), 'value') == ''){
        
        //alert('setto la mandataria');
        //setto il ruolo a mandataria
        SetProperty(getObjGrid('val_RRTIGRIDGrid_0_Ruolo_Impresa'),'value','Mandataria');
        getObjGrid('val_RRTIGRIDGrid_0_Ruolo_Impresa').innerHTML='Mandataria';
        getObjGrid('RRTIGRIDGrid_0_Ruolo_Impresa').value='Mandataria';
      }
        
      
      
      //nascondo il cestino prima riga
      getObjGrid('RRTIGRIDGrid_0_FNZ_DEL').style.display='none';
      //disabilito onclick sul cestino prima riga
    	getObj('RTIGRIDGrid_r0_c1').onClick = '';
    	//disabilito onchange su codice fiscale prima riga
      getObjGrid('RRTIGRIDGrid_0_codicefiscale').onchange = '';  
      
      
      for ( nIndRrow=1; nIndRrow <= NumRowRti; nIndRrow++){	
      
        SetProperty(getObjGrid('val_RRTIGRIDGrid_' + nIndRrow + '_Ruolo_Impresa'),'value','Mandante');
        getObjGrid('val_RRTIGRIDGrid_' + nIndRrow + '_Ruolo_Impresa').innerHTML='Mandante';
      
      }
    }
    
    //setto onkeyup
    SetOnChangeOnCodiceFiscale('RTIGRIDGrid');
    
    //aggiorno il campo denominazioneATI
    UpgradeDenominazioneRTI();

}



//SETTO EVENTO ON CHANGE SULLA COLONNA CODICE FISCALE DELLE GRIGLIE RTI
function SetOnChangeOnCodiceFiscale( strFullNameArea ){
        
  var nNumRow = GetProperty(getObj(strFullNameArea),'numrow');
  var nIndRrow;
  for ( nIndRrow=0; nIndRrow<=nNumRow; nIndRrow++){	
    
    if ( nIndRrow == 0 && strFullNameArea == 'RTIGRIDGrid'){
      
    	//disabilito onkeyup su codice fiscale
      getObjGrid( 'R' + strFullNameArea + '_' + nIndRrow + '_codicefiscale').onkeyup = '';  
      
    }else{
      getObjGrid( 'R' + strFullNameArea + '_' + nIndRrow + '_codicefiscale').onkeyup = GetInfoAziendaFromCF ;
      //getObjGrid( 'R' + strFullNameArea + '_' + nIndRrow + '_codicefiscale').onblur = MakeAlertAzienda ;
    }
    
  }               
  
}




//ricostruisce il campo denominazione
function UpgradeDenominazioneRTI( ){
    
    var strTempValue;
    //aggiorno campo nascosto con la denominazione
    var objDenominazioneATI = getObj( 'DenominazioneATI' );
    objDenominazioneATI.value = '';
    
    var nIndRrow;
    var strFullNameArea;
    var nNumRow;
    
    //controllo se partecipacomeRTI è settato
    if ( getObj('PartecipaFormaRTI').value == '1' ){
      
      strFullNameArea='RTIGRIDGrid';
      nNumRow=Number(GetProperty(getObj( strFullNameArea ),'numrow'));
      
      if  ( nNumRow >=0 && getObjGrid('R' + strFullNameArea + '_0_RagSoc').value != '' ){
        
        objDenominazioneATI.value = 'RTI ';
        
        for ( nIndRrow=0; nIndRrow <= nNumRow; nIndRrow++){	
          
          strTempValue = getObjGrid('R' + strFullNameArea + '_' + nIndRrow + '_RagSoc').value;
          
          if ( strTempValue != '' ){
            if (nIndRrow == 0)
              objDenominazioneATI.value =  objDenominazioneATI.value  + strTempValue ;
            else
              objDenominazioneATI.value =  objDenominazioneATI.value  + ' - ' + strTempValue ;
          }
          
        }    
      }
    }
    
    
    
    //controllo se InserisciEsecutriciLavori è settato
    if ( getObj('InserisciEsecutriciLavori').value == '1' ){
		  
      strFullNameArea='ESECUTRICIGRIDGrid';
      nNumRow=Number(GetProperty(getObj( strFullNameArea ),'numrow'));
      
      if  ( nNumRow >=0 && getObjGrid('R' + strFullNameArea + '_0_RagSoc').value != '' ){
        
        objDenominazioneATI.value = objDenominazioneATI.value + ' Esecutrice ';
        
        for ( nIndRrow=0; nIndRrow <= nNumRow; nIndRrow++){	
          
          strTempValue = getObjGrid('R' + strFullNameArea + '_' + nIndRrow + '_RagSoc').value;
          
          if ( strTempValue != '' ){
            if (nIndRrow == 0)
              objDenominazioneATI.value =  objDenominazioneATI.value  + strTempValue ;
            else
              objDenominazioneATI.value =  objDenominazioneATI.value  + ' - ' + strTempValue ;
          }
          
        }
        
        //se non è settata RTI aggiungo all'inizio la ragsoc del consorzio
    		if ( getObj('PartecipaFormaRTI').value != '1'	){
    			objDenominazioneATI.value = getObjGrid('R' + strFullNameArea + '_0_RagSocRiferimento').value + ' ' + objDenominazioneATI.value ;
    		}
            
      }
    }
    
    
    //se il campo DenominazioneATI è vuoto setto la ragione sociale del fornitore che ha fatto l'offerta
    if (objDenominazioneATI.value == ''){
      
      ajax = GetXMLHttpRequest(); 
  
    	if(ajax){
    		  
          ajax.open("GET", '../../ctl_library/functions/InfoAziFromCF.asp?IdAzi=' + getObj('Azienda').value, false);
    	 		 
    			ajax.send(null);
    			
    			if(ajax.readyState == 4) {
    			  
    				if(ajax.status == 200)
    				{
    			    if ( ajax.responseText != '' ) {
    			      
    			     //alert(ajax.responseText);
    			     var strTempValue = ajax.responseText;
    			     var ainfo=strTempValue.split('#');
    			       objDenominazioneATI.value =ainfo[0] ;
                 
              }
         		}
    			}
    
    	}
      
      
    } 
        
    
}




//per eseguire aggiungi esecutrici e aggiungi ausiliarie
function My_Detail_AddFrom (param){
  
  //recupero le aziende della griglia RTI
  var strIdaziRTI = GetAziRTI();
  //alert(strIdaziRTI);
  
  var strIdAziEsecutrici = GetEsecutriciConsorzio();
   //alert(strIdAziEsecutrici);
   if (strIdAziEsecutrici != '')
    strIdaziRTI = strIdaziRTI + ',' + strIdAziEsecutrici;
  
  var npos=strIdaziRTI.indexOf(',');
   
  if (npos == -1){
  
    //aggiungo direttamente l'azienda loggata
    
    //recupero azienda fornitore che ha fatto il documento
    var Azienda = getObj('Azienda').value ;
    var strDoc = getQSParamFromString( param , 'DOCUMENT'); 
    v = strDoc.split('.');
    
    //-- compone il comando per aggiungere la riga
    strCommand = v[0] + '#' + v[1] + '#' + 'IDROW=' + Azienda + '&TABLEFROMADD=' + v[2];
    ExecDocCommand( strCommand );
       
    //ShowLoading( sec );
  
  }else{
  
    vet = param.split( '#' );

  	var w;
  	var h;
  	var Left;
  	var Top;
  	var altro;
  
  	if( vet.length < 3  )
      	{
  		w = screen.availWidth;
  		h = screen.availHeight;
  		Left=0;
  		Top=0;
  	}
  	else    
  	{
  		var d;
  		d = vet[2].split( ',' );
  		w = d[0];
  		h = d[1];
  		Left = (screen.availWidth-w)/2;
  		Top  = (screen.availHeight-h)/2;
  		
  		if( vet.length > 3 )
  		{
  			altro = vet[3];
  		}
  	}
	 
	  var strUrl = vet[0];
  
    strUrl = strUrl + '&FilterHide= id in (' + strIdaziRTI + ')' ;
  
    return window.open(  strUrl ,vet[1],'toolbar=no,location=no,directories=no,status=no,menubar=no,resizable=yes,copyhistory=yes,scrollbars=yes,left=' + Left + ',top=' + Top + ',width=' + w + ',height=' + h + altro );
  }
}



//recupera la lista delle aziende della griglia RTI
function GetAziRTI(){
    
    var strTempList='';
    var strTempValue='';
    
    var nIndRrow;
    
    var nNumRow = GetProperty( getObj('RTIGRIDGrid') ,'numrow');
    
    //alert(nNumRow)
    if  ( nNumRow >= 0 ){
      
      for ( nIndRrow=0; nIndRrow <= nNumRow; nIndRrow++){	
        
        strTempValue = getObjGrid('RRTIGRIDGrid_' + nIndRrow + '_IdAzi').value;
        if (strTempValue != ''){
          if ( strTempList == '' )
            strTempList =  strTempValue ;
          else
            strTempList =  strTempList + ',' + strTempValue ;
        }
      }    
    }else{
      
      //recupero idazi azienda loggata
      strTempList = getObj('Azienda').value ;
    }
    
    return strTempList;
    
}



//recupera la lista delle aziende esecutrici nei CONSORZI
function GetEsecutriciConsorzio(){
  
  var strTempList='';
  var strTempValue='';
  
  var nIndRrow;
  
  var nNumRow = GetProperty( getObj('ESECUTRICIGRIDGrid') ,'numrow');
  
  
  if  ( nNumRow >= 0 ){
    
    for ( nIndRrow=0; nIndRrow <= nNumRow; nIndRrow++){	
      strTempValue = getObjGrid('RESECUTRICIGRIDGrid_' + nIndRrow + '_IdAzi').value;
      if (strTempValue != ''){
        if ( strTempList == '' )
          strTempList =  strTempValue ;
        else
          strTempList =  strTempList + ',' + strTempValue ;
      }
    }    
  }else{
    
    //recupero idazi azienda loggata
    strTempList = getObj('Azienda').value ;
  }
  
  return strTempList;
    
  
}





//a partire dal codice fiscale ritorna le info di azienda
function GetInfoAziendaFromCF(  ) {
    
    //RRTIGRIDGrid_0_codicefiscale
    var strNameCtl = this.name;
    
    var aInfo = strNameCtl.split('_');
    
    
    
    var nIndRrow = aInfo[1];
    
    var strCF=this.value;
    
    var Grid=aInfo[0].substr(1,aInfo[0].length);
    
    
    var ValoreListaAlbi='';
    
    //tranne che per le aziende avvalimento considero ListaAlbi
    if ( Grid != 'AUSILIARIEGRIDGrid' ){
      try{
         ValoreListaAlbi =  getObj('ListaAlbi').value ;
      }catch(e){}
    } 
    
    //alert(strCF);
    if (strCF.length >= 11 ){
      
      //if  ( bIsUnique ){
      
        //provo a ricercare le info azienda
        ajax = GetXMLHttpRequest(); 
  
      	if(ajax){
      		  
				ajax.open("GET", '../../ctl_library/functions/InfoAziFromCF.asp?ListaAlbi=' + encodeURIComponent(ValoreListaAlbi) + '&FilterHide=azivenditore<>0 and aziacquirente=0&CodiceFiscale=' + encodeURIComponent(strCF), false);
      	 		 
      			ajax.send(null);
      			
      			if(ajax.readyState == 4) {
      			  //alert(ajax.status);
      				if(ajax.status == 200)
      				{
      				  //alert(ajax.responseText);
      			    if ( ajax.responseText != '' &&  ajax.responseText.indexOf('#', 0) > 0 ) {
      			      
      			      //alert(ajax.responseText);    
      			      this.style.color='black';
                  var strresult = ajax.responseText;
                  
                  SetInfoAziendaRow( Grid , nIndRrow , strresult );
                  
                  //faccio alert se azienda presente in altra griglia
                  var bIsUnique = AziIsUnique( Grid , nIndRrow, strCF );
                  
                }else{
                  
                  if ( ajax.responseText != '' )
                    LocDMessageBox( '../' , ajax.responseText  , 'Attenzione' , 1 , 400 , 300 ) ;
                  
                  //setto i caratteri in rosso
                  this.style.color='red';
                  
                  //svuoto i campi
                  SetInfoAziendaRow( Grid , nIndRrow ,'#####' );
                  
                  
                }
           		}
      			}
      
      	}
      //}else{
        
        //svuoto il campo del CF che non è univoco
      //  this.value='';
      //  SetInfoAziendaRow( Grid , nIndRrow ,'#####' );
      //}
    }else{
      //setto i caratteri in rosso
      this.style.color='red';
                  
      //svuoto i campi
      SetInfoAziendaRow( Grid , nIndRrow ,'#####' );
    }
    
    //aggiorno campo denominazione
    UpgradeDenominazioneRTI();
}



  
//controlla che questo codice fiscale non sia già presente
function AziIsUnique ( strNameAreaCurrent , nRowCurrent , strCF ){
    
    var bIsUnique=true;
    
    //griglia RTI
    var nIndRrow;
    var strFullNameArea='RTIGRIDGrid';
    
    var nNumRow=Number(GetProperty(getObj( strFullNameArea ),'numrow'));
    
    for ( nIndRrow=0; nIndRrow <= nNumRow; nIndRrow++){	
      
      if ( strFullNameArea != strNameAreaCurrent || ( strFullNameArea == strNameAreaCurrent && Number(nIndRrow) != Number(nRowCurrent) ) ){
          
          if (  getObjGrid('R' + strFullNameArea + '_' + nIndRrow + '_codicefiscale').value.toUpperCase() == strCF.toUpperCase() ){
            //alert( CNV ('../../' , 'azienda gia inserita nella griglia RTI') );
            LocDMessageBox( '../' , 'azienda gia inserita nella griglia RTI'  , 'Attenzione' , 1 , 400 , 300 ) ;
            bIsUnique=false;
            return bIsUnique;
          }
      }
    }    
    
    
    
    //griglia Consorzio
    strFullNameArea='ESECUTRICIGRIDGrid';
    nNumRow=-1;
    nNumRow=Number(GetProperty(getObj( strFullNameArea ),'numrow'));
    
    for ( nIndRrow=0; nIndRrow <= nNumRow; nIndRrow++){	
      
      if ( strFullNameArea != strNameAreaCurrent || ( strFullNameArea == strNameAreaCurrent && Number(nIndRrow) != Number(nRowCurrent) ) ){
          
          if (  getObjGrid('R' + strFullNameArea + '_' + nIndRrow + '_codicefiscale').value.toUpperCase() == strCF.toUpperCase() ){
            //alert( CNV ('../../' , 'azienda gia inserita nella griglia Consorzio') );
            LocDMessageBox( '../' , 'azienda gia inserita nella griglia Consorzio'  , 'Attenzione' , 1 , 400 , 300 ) ;
            bIsUnique=false;
            return bIsUnique;
          }
      }
    }
    
    
    //griglia Avvalimento
    strFullNameArea='AUSILIARIEGRIDGrid';
    nNumRow=-1;
    nNumRow=Number(GetProperty(getObj( strFullNameArea ),'numrow'));
    
    for ( nIndRrow=0; nIndRrow <= nNumRow; nIndRrow++){	
      
      if ( strFullNameArea != strNameAreaCurrent || ( strFullNameArea == strNameAreaCurrent && Number(nIndRrow) != Number(nRowCurrent) ) ){
          
          if (  getObjGrid('R' + strFullNameArea + '_' + nIndRrow + '_codicefiscale').value.toUpperCase() == strCF.toUpperCase() ){
            //alert( CNV ('../../' , 'azienda gia inserita nella griglia Avvalimento') );
            LocDMessageBox( '../' , 'azienda gia inserita nella griglia Avvalimento'  , 'Attenzione' , 1 , 400 , 300 ) ;
            bIsUnique=false;
            return bIsUnique;
          }
      }
    }
    
    
    return bIsUnique;
  
}

  
//setta le info di una azienda su una riga di una griglia
function SetInfoAziendaRow( strFullNameArea, nIndRrow ,strresult ){
    
    
    var nPos;
    var ainfoAzi = strresult.split('#');
    
    var strRagSoc = ainfoAzi[0];
    
    getObjGrid('R' + strFullNameArea + '_' + nIndRrow + '_RagSoc').value=strRagSoc;
    getObjGrid('R' + strFullNameArea + '_' + nIndRrow + '_RagSoc_V').innerHTML=strRagSoc;
    
    
    /*
    if (strFullNameArea == 'DOCUMENTAZIONE_ATIgriglia' && nIndRrow==0){
      var strCodicefiscale = ainfoAzi[4];
      getObjGrid('R' + strFullNameArea + '_' + nIndRrow + '_codicefiscale').value=strCodicefiscale;
    }*/
    
    var strIndLeg = ainfoAzi[1];
    getObjGrid('R' + strFullNameArea + '_' + nIndRrow + '_INDIRIZZOLEG').value=strIndLeg;
    getObjGrid('R' + strFullNameArea + '_' + nIndRrow + '_INDIRIZZOLEG_V').innerHTML=strIndLeg;
    
    var strLocLeg = ainfoAzi[2];
    getObjGrid('R' + strFullNameArea + '_' + nIndRrow + '_LOCALITALEG').value=strLocLeg;
    getObjGrid('R' + strFullNameArea + '_' + nIndRrow + '_LOCALITALEG_V').innerHTML=strLocLeg;  
    
    
    var strProvLeg = ainfoAzi[3];
    getObjGrid('R' + strFullNameArea + '_' + nIndRrow + '_PROVINCIALEG').value=strProvLeg;
    getObjGrid('R' + strFullNameArea + '_' + nIndRrow + '_PROVINCIALEG_V').innerHTML=strProvLeg;  
      
    
    
    var strIdazi = ainfoAzi[5];
    getObjGrid('R' + strFullNameArea + '_' + nIndRrow + '_IdAzi').value = strIdazi ;
    
    
    var strRuolo='Mandataria';
    var strTechRuolo='Mandataria';
    if (nIndRrow != 0 ){
      strRuolo='Mandante';
      strTechRuolo='Mandante';
    }
    
    
    if (strresult == '#####'){
      strRuolo='';
      strTechRuolo='';
    }
      
    //getObjGrid('R' + strFullNameArea + '_' + nIndRrow + '_Ruolo_Impresa').value=strRuolo;
    //getObjGrid('val_R' + strFullNameArea + '_' + nIndRrow + '_Ruolo_Impresa').innerHTML=strTechRuolo;   
    
    try{
      //SetProperty(getObjGrid('val_R' + strFullNameArea + '_' + nIndRrow + '_Ruolo_Impresa'),'value',strTechRuolo);
      
      getObjGrid('val_R' + strFullNameArea + '_' + nIndRrow + '_Ruolo_Impresa').innerHTML=strRuolo;
      getObjGrid('R' + strFullNameArea + '_' + nIndRrow + '_Ruolo_Impresa').value = strTechRuolo ;
      
    }catch(e){}
    
}  


//viene eseguita dopo i comandio sulla griglia RTI
function ESECUTRICIGRID_AFTER_COMMAND( command ){
    
    
    
    if ( command == 'DELETE_ALL'){
      
      //se ho cancellato la griglia nascondo area relativa
      getObj('div_ESECUTRICIGRIDGrid').style.display='none';
      getObj('OFFERTA_PARTECIPANTI_ESECUTRICI_TOOLBAR_ADDFROM').style.display='none';
    
    }else{
      
      getObj('div_ESECUTRICIGRIDGrid').style.display='';
      getObj('OFFERTA_PARTECIPANTI_ESECUTRICI_TOOLBAR_ADDFROM').style.display='';
    
    }
    
    //setto onkeyup
    SetOnChangeOnCodiceFiscale('ESECUTRICIGRIDGrid');
    
    //aggiorno il campo denominazioneATI
    UpgradeDenominazioneRTI();

}


//viene eseguita dopo i comandio sulla griglia RTI
function AUSILIARIEGRID_AFTER_COMMAND( command ){
    
    
    
    if ( command == 'DELETE_ALL'){
      
      //se ho cancellato la griglia nascondo area relativa
      getObj('div_AUSILIARIEGRIDGrid').style.display='none';
      getObj('OFFERTA_PARTECIPANTI_AUSILIARIE_TOOLBAR_ADDFROM').style.display='none';
    
    }else{
      
      getObj('div_AUSILIARIEGRIDGrid').style.display='';
      getObj('OFFERTA_PARTECIPANTI_AUSILIARIE_TOOLBAR_ADDFROM').style.display='';
    
    }
    
    //setto onkeyup
    SetOnChangeOnCodiceFiscale('AUSILIARIEGRIDGrid');
    
    //aggiorno il campo denominazioneATI
    UpgradeDenominazioneRTI();
    
}



//alert se azienda non trovata su onblur dal campo codicefiscale
function MakeAlertAzienda() {

  var strNameCtl = this.name;
  
  var aInfo = strNameCtl.split('_');
  
  var nIndRrow = aInfo[1];
  
  var strCF=this.value;
  
  var strFullNameArea  =aInfo[0].substr(1,aInfo[0].length);
  
  //alert(getObjGrid('R' + strFullNameArea + '_' + nIndRrow + '_RagSoc').value);
  
  if ( getObjGrid('R' + strFullNameArea + '_' + nIndRrow + '_RagSoc').value == '' ) 
    //alert(CNV ('../../' , 'codice fiscale azienda non esistente') );
    LocDMessageBox( '../' , 'codice fiscale azienda non esistente'  , 'Attenzione' , 1 , 400 , 300 ) ;
}





//CONTROLLA CHE IN CASO DI RTI LA COMPILAZIONE E' OK
function CanSendRTI(){
  
  
  
  var bret=false;
  
  
  //aggiorno coerentemente il campo denominazione ati
  UpgradeDenominazioneRTI();
  
  //controllo se partecipacomeRTI è settato che la griglia RTi è compilata correttamente
  bret = CanSendGridRTI( 'RTIGRIDGrid', 'PartecipaFormaRTI' , 'mandante'   );
  if ( ! bret){
    return false;
  }
  
  //controllo che per la RTI le righe devo essere almeno 2
  strFullNameArea='RTIGRIDGrid';
  nNumRow=Number(GetProperty(getObj( strFullNameArea ),'numrow'));
  if (nNumRow == 0){
    //alert( CNV ('../../' , 'inserire almeno una mandante') );
    LocDMessageBox( '../' , 'inserire almeno una mandante' , 'Attenzione' , 1 , 400 , 300 );
    return false;
  }
  
  //se ho settato Consorzio a si controllo che la griglia consorzio è compilata correttamente
  bret=false;
  bret = CanSendGridRTI( 'ESECUTRICIGRIDGrid', 'InserisciEsecutriciLavori' , 'esecutrice'   )
  if ( ! bret){
    return false;
  }
  
  //controllo che i consorzi della griglia Consorzio sono tutti nella griglia RTI
  bret=false;
  bret = RiferimentiGridIsInRTI( 'ESECUTRICIGRIDGrid' , 'RagSocRiferimento' , 'IdAziRiferimento'  );
  if ( ! bret){
    return false;
  }
  
  //se ho settatto RicorriAvvalimento controllo che la griglia avvalimento è compilata correttamente
  bret=false;
  bret = CanSendGridRTI( 'AUSILIARIEGRIDGrid', 'RicorriAvvalimento' , 'ausiliaria'   )
  if ( ! bret){
    return false;
  }
	
	//controllo che le ausiliate  della griglia Avvalimenti sono tutti nella griglia RTI
  bret=false;
  bret = RiferimentiGridIsInRTI( 'AUSILIARIEGRIDGrid' , 'RagSocRiferimento', 'IdAziRiferimento' );
  if ( ! bret){
    return false;
  }
	
	
  return true;
  
}



//controlla che una griglia è compilata correttamente
function CanSendGridRTI( strFullNameArea, strAttrib , strCnv   ){

  
  var iddztAttrib;
  var objAttrib;
    
  if ( getObj(strAttrib).value == '1' ){
  
    nNumRow=Number(GetProperty(getObj( strFullNameArea ),'numrow'));
    
    if (nNumRow == -1 ){
      
      alert( CNV ('../../' , 'inserire almeno una ' + strCnv ) );
      return false;
       
    }else{
    
      for ( nIndRrow=0; nIndRrow <= nNumRow; nIndRrow++ ){
        
        if ( getObjGrid('R' + strFullNameArea + '_' + nIndRrow + '_RagSoc').value != '' == '' ){
          
          //alert( CNV ('../../' , 'inserire codice fiscale della ' + strCnv ) );
          LocDMessageBox( '../' , 'inserire codice fiscale della ' + strCnv  , 'Attenzione' , 1 , 400 , 300 );
          
          return false;
          
        }
      }    
    }
  }
  
  return true;
  
}



//CONTROLLA CHE LE AZIENDE DI RIFERIMENTO DELLA GRIGLIA IN INPUT SIANO PRESENTI NELLA GRIGLIA RTI
//OPPURE DEVE ESSERE SOLO L'AZIENDA LOGGATA
function RiferimentiGridIsInRTI( strFullNameArea, strAttribRagSoc, strAttribIdAzi  ){
    
    var strListAziendeRTI= GetAziRTI() ;
    
    var strIdAziEsecutrici = GetEsecutriciConsorzio();
    
    if (strIdAziEsecutrici != '')
      strListAziendeRTI = strListAziendeRTI + ',' + strIdAziEsecutrici;
    
    strListAziendeRTI = ',' + strListAziendeRTI + ','
    
    
    //determino se esiste un raggruppamento RTI
    var bRTI=true;
    var strFullNameAreaRTI='RTIGRIDGrid';
    var nNumRowRTI =Number(GetProperty(getObj( strFullNameAreaRTI ),'numrow'));
    
    if  ( nNumRowRTI == -1 )
      bRTI=false;
    
    
    var nNumRow =  Number(GetProperty(getObj( strFullNameArea ),'numrow'));
    
    var strCurrIdAzi = '';
    
	  if ( nNumRow >= 0 ) {
      
      var nIndRrow;
      
      for ( nIndRrow=0; nIndRrow<=nNumRow; nIndRrow++){	
        
        strCurrIdAzi  = ',' + getObjGrid('R' + strFullNameArea + '_' + nIndRrow + '_' + strAttribIdAzi ).value + ',';
        strCurrRagSoc =  getObjGrid('R' + strFullNameArea + '_' + nIndRrow + '_' + strAttribRagSoc ).value ;
        
        if ( strListAziendeRTI.indexOf(strCurrIdAzi, 0) < 0 ){
          if (bRTI)
            alert( CNV ('../../' , 'attenzione azienda area ' + strFullNameArea ) + ' "' + strCurrRagSoc + '" ' + CNV ('../../' , 'non presente in rti' )   );
            //DMessageBox( '../' , 'attenzione azienda area ' + strFullNameArea  , 'Attenzione' , 1 , 400 , 300 ) 
          else
            alert( CNV ('../../' , 'attenzione azienda area ' + strFullNameArea ) + ' "' + strCurrRagSoc + '" ' + CNV ('../../' , 'non azienda loggata' )   );
          
          return false;
          
        }
          
        
      }  
    }
    
    return true;
    
}


function ControlliOfferta(param){
  
  //CONTROLLO IN CASO DI RTI
  var bret = false;
  var bret=CanSendRTI();
  
  if ( ! bret ){
    return false;
  }
  
  return true;

  
}




// end script -->
</script>
</body>
</html>