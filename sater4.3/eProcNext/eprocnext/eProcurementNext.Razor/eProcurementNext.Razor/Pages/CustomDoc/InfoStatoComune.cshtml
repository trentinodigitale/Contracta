@page "/CustomDoc/InfoStatoComune.asp"
@inject eProcurementNext.Session.ISession session;
@using eProcurementNext.CommonDB;
@using eProcurementNext.CommonModule;
@using static eProcurementNext.CommonModule.Basic;
@using eProcurementNext.BizDB;
@using eProcurementNext.HTML;
@using eProcurementNext.Application;
@using static eProcurementNext.Razor.Pages.CustomDoc.InfoStatoComuneModel;
@using Microsoft.VisualBasic;
@model eProcurementNext.Razor.Pages.CustomDoc.InfoStatoComuneModel
@using static eProcurementNext.Session.SessionMiddleware
@{
	CommonDbFunctions cdf = new();
	LoadSession(HttpContext, session);
	EprocResponse htmlToReturn = new();
}
@{
	string Comune = GetParamURL(Request.QueryString.ToString(), "comune");
	var SqlParameters = new Dictionary<string, object?>();
    SqlParameters.Add("@comune", Comune);
	
	//'- Recupero le info per il comune passato
	TSRecordSet? rs = cdf.GetRSReadFromQuery_("select SoloDenominazione_in_italiano from GEO_ISTAT_elenco_comuni_italiani where SoloDenominazione_in_italiano = @comune ", ApplicationCommon.Application.ConnectionString, SqlParameters);

	if (rs.RecordCount >0)
	{
		htmlToReturn.Write("1");
	}
	else
	{
		htmlToReturn.Write("0");
	}
}
@Html.Raw(htmlToReturn.Out())