@page "/Portale/rss_quesiti.asp"
@inject eProcurementNext.Session.ISession session;
@using eProcurementNext.CommonDB
@using eProcurementNext.DashBoard
@using eProcurementNext.CommonModule;
@using static eProcurementNext.CommonModule.Basic;
@using eProcurementNext.BizDB;
@using eProcurementNext.HTML;
@using eProcurementNext.Application;
@using static eProcurementNext.HTML.BasicFunction;
@using static eProcurementNext.DashBoard.Basic;
@using Microsoft.VisualBasic;
@model eProcurementNext.Razor.Pages.Portale.rss_quesitiModel
@using static eProcurementNext.Session.SessionMiddleware
@{
	LoadSession(HttpContext, session);

	var sort = GetParamURL(Request.QueryString.ToString(), "sort");
	if(string.IsNullOrEmpty(sort))
	{
		//'sort = "datacreazione"
		sort = "DataRisposta";
	}
	var sortOrder = GetParamURL(Request.QueryString.ToString(), "sortorder");
	if(string.IsNullOrEmpty(sortOrder))
	{
		sortOrder = "desc";
	}
	var mlKey = GetParamURL(Request.QueryString.ToString(), "ML_KEY");
	if (string.IsNullOrEmpty(mlKey))
	{
		mlKey = "TEMPLATE_RSS_QUESITI_ML";
	}
	
	HttpContext.Response.Redirect("rss_new.asp?Table=view_Document_Chiarimenti_portale&FilterHide=" + UrlEncode(GetParamURL(Request.QueryString.ToString(), "FilterHide")) + "&Filter=" + UrlEncode(GetParamURL(Request.QueryString.ToString(), "Filter")) + "&ML_KEY=" + mlKey + "&sort=" + sort + "&sortorder=" + sortOrder);
}