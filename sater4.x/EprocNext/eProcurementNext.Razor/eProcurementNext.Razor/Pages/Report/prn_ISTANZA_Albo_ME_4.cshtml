@page "/Report/prn_ISTANZA_Albo_ME_4.asp"
@inject eProcurementNext.Session.ISession session;
@using eProcurementNext.CommonDB
@using eProcurementNext.CommonModule;
@using static eProcurementNext.CommonModule.Basic;
@using eProcurementNext.BizDB;
@using eProcurementNext.HTML;
@using eProcurementNext.Application;
@using Microsoft.VisualBasic
@using System.Globalization
@using static eProcurementNext.CommonDB.Basic;
@using static eProcurementNext.Razor.Pages.CTL_LIBRARY.DOCUMENT.print_documentModel;
@using static eProcurementNext.Razor.Pages.CTL_LIBRARY.DOCUMENT.CommonModel;
@using static eProcurementNext.Razor.Pages.CTL_LIBRARY.functions.securityModel;
@using static eProcurementNext.Session.SessionMiddleware
@using static eProcurementNext.Razor.Pages.Report.prn_ISTANZA_Albo_ME_4Model;
@model eProcurementNext.Razor.Pages.Report.prn_ISTANZA_Albo_ME_4Model
@{

    CommonDbFunctions cdf = new();
    LoadSession(HttpContext, session);
    EprocResponse htmlToReturn = new();
    objDoc = PrintDocument(session, htmlToReturn, HttpContext, Response, Request);//PrintDocument ok
    var sqlParams = new Dictionary<string, object?>();
    htmlToReturn.Write($@"
	<html>
	<head>");
    string id = GetParamURL(Request.QueryString.ToString(), "IDDOC");
    string LanguageSuffix = GetParamURL(Request.QueryString.ToString(), "LanguageSuffix");
    validate("IDDOC", id, TIPO_PARAMETRO_INT, SOTTO_TIPO_VUOTO, "", 1, HttpContext, session);
    validate("LanguageSuffix", LanguageSuffix, TIPO_PARAMETRO_STRING, SOTTO_TIPO_PARAMETRO_PAROLASINGOLA, "", 0, HttpContext, session);


    addMetaTag(htmlToReturn);

    TSRecordSet rsclassiiscrizione = null;
    //set rsclassiiscrizione = nothing

    string getClasseIscrizione(string cod)
    {
        string _getClasseIscrizione = "";
        try
        {
            if (rsclassiiscrizione == null)
            {
                sqlParams.Clear();
                sqlParams.Add("@language", LanguageSuffix.Replace("'", "''"));
                rsclassiiscrizione = cdf.GetRSReadFromQuery_("SELECT  DMV_DescML , DMV_Cod  FROM  ClasseIscriz_MLNG where ML_LNG=@language", ApplicationCommon.Application.ConnectionString, sqlParams);

            }
            rsclassiiscrizione.Filter("DMV_Cod = '" + cod + "'");
            if (!(rsclassiiscrizione.EOF && rsclassiiscrizione.BOF))
            {
                _getClasseIscrizione = CStr(rsclassiiscrizione["DMV_DescML"]);
            }
            else
            {
                _getClasseIscrizione = "";
            }
        }
        catch
        {

        }
        return _getClasseIscrizione;
    }
    //dynamic getVersioneDoc()
    //{
    //    dynamic _getVersioneDoc = null;
    //    sqlParams.Clear();
    //    sqlParams.Add("@id", id);
    //    TSRecordSet? rs5 = cdf.GetRSReadFromQuery_("Select Versione from ctl_doc where id=@id", ApplicationCommon.Application.ConnectionString, sqlParams);
    //    if (rs5 is not null && rs5.RecordCount > 0)
    //    {
    //        rs5.MoveFirst();
    //        _getVersioneDoc = CStr(rs5["Versione"]);
    //    }
    //    return _getVersioneDoc;
    //}
    //string getClasseMerceologica(string cod)
    //{
    //    TSRecordSet rs = null;
    //    string _getClasseMerceologica = "";
    //    try
    //    {
    //        sqlParams.Clear();
    //        sqlParams.Add("@cod", cod);
    //        rs = cdf.GetRSReadFromQuery_("SELECT  DMV_DescML  FROM Categorie_Merceologiche  where DMV_COD=@cod", ApplicationCommon.Application.ConnectionString, sqlParams);
    //        rs.MoveFirst();
    //        _getClasseMerceologica = CStr(rs["DMV_DescML"]);

    //    }
    //    catch
    //    {

    //    }
    //    return _getClasseMerceologica;
    //}
    string getProvincia(string cod)
    {
        string _getProvincia = string.Empty;
        TSRecordSet? rs = cdf.GetRSReadFromQuery_("declare @descrizione as nvarchar(MAX) set @descrizione='' select @descrizione=@descrizione + DMV_DescML + ',' from dbo.Split('" + cod + "','###') inner join LIB_DomainValues on DMV_DM_ID='GEO' and DMV_Cod=items select substring(@descrizione,0,len(@descrizione)) as descrizione", ApplicationCommon.Application.ConnectionString);
        if (rs is not null && rs.RecordCount > 0)
        {
            rs.MoveFirst();
            _getProvincia = CStr(rs["descrizione"]);
        }
        return _getProvincia;
    }
    //dynamic getNumeroDetermina(dynamic cod)
    //{
    //    TSRecordSet rs1 = null;
    //    dynamic _getNumeroDetermina = null;
    //    try
    //    {
    //        sqlParams.Clear();
    //        sqlParams.Add("@codice", cod);
    //        rs1 = cdf.GetRSReadFromQuery_("select dgrN from  Document_Bando where idheader=@codice", ApplicationCommon.Application.ConnectionString, sqlParams);
    //        rs1.MoveFirst();
    //        _getNumeroDetermina = CStr(rs1["dgrN"]);
    //    }
    //    catch
    //    {

    //    }
    //    return _getNumeroDetermina;
    //}
    //dynamic getDeterminaDel(string cod)
    //{
    //    dynamic _getDeterminaDel = null;
    //    TSRecordSet rs2 = null;
    //    try
    //    {
    //        sqlParams.Clear();
    //        sqlParams.Add("@cod", cod);
    //        rs2 = cdf.GetRSReadFromQuery_("select dgrDel from  Document_Bando where idheader=@cod", ApplicationCommon.Application.ConnectionString, sqlParams);
    //        rs2.MoveFirst();
    //        _getDeterminaDel = CStr(rs2["dgrDel"]);
    //    }
    //    catch
    //    {

    //    }
    //    return _getDeterminaDel;
    //}
    int NumPag;
    NumPag = 0;
    /*dynamic iif(dynamic a,dynamic b,dynamic c)
    {
        if(a)
        {
            return b;
        }
        else
        {
            return c;
        }
    }*/
    htmlToReturn.Write($@"
	</head>
	<body");
    if ((DOC_FieldTecnical("DOCUMENT", "StatoDoc") == "Saved" || string.IsNullOrEmpty(DOC_FieldTecnical("DOCUMENT", "StatoDoc"))) && (GetParamURL(Request.QueryString.ToString(), "TO_SIGN") == "no" || string.IsNullOrEmpty(GetParamURL(Request.QueryString.ToString(), "TO_SIGN"))))
    {
        htmlToReturn.Write($@" style=""background-image:url(../images/bozza.jpg)"" ");
    }
    htmlToReturn.Write($@"
	>
		<style type=""text/css"">



			BODY,DIV ,TABLE, TD {{
			font-family:'Arial','Times New Roman',serif;
			font-size:9.9pt;
			font-style:normal;
			font-weight:normal


			}}
			.Input
			{{
			font-family:'Arial','Times New Roman',serif;
			font-size:10pt;
			font-style:normal;
			font-weight:bold

			}}

			.TITLE{{
			font-family:'Arial','Times New Roman',serif;
			font-size:12pt;
			font-style: bold;
			font-weight:bold



			}}
			.prodotti
			{{
			font-family:'Arial','Times New Roman',serif;
			font-size:7pt;
			font-style:normal;
			font-weight:bold

			}}



			@media print
			{{
			#Ricevuta {{}}
			}}

			@media screen
			{{
			#Ricevuta {{}}
			}}

			  ul li, table ul li {{ list-style-type:none; text-align:justify; }}
			  p	{{  text-align:justify;}}
			 .disc li {{ list-style-type:disc;}}
			 .disc li table td{{ vertical-align:bottom;}}
			  h1{{font-size:1.3em; font-weight:bold; text-align:center;}}
			 .PaddingLeft{{ padding-left:3em;}}
			 .nomargin{{margin-top: -13px;}}
			  ul.ListStyleTypeNone li{{padding-top:0em; }}
			 .ListStyleTypeNone{{ list-style-type:none; }}
			 table.list{{ vertical-align:middle; margin-top:1em;}}
			 ul.disc{{padding-left:0em;}}
			 table td ul.disc{{padding-top:0em;padding-bottom:0em;margin-top: 0em;margin-bottom: 0em;}}
			 .DataGUUE{{ width:25em;}}
			.DataGURI{{ width:17em;}}
			ul.ListStyleTypeNone {{padding-left:0em; }}
			.DICHIARAZIONE_EVENTUALE {{ border: 1px solid; padding: 10px;}}

		</style>");
    htmlToReturn.Write($@"
		<div style=""text-align: center;"">
			<center>
				<table style=""width: 800px; height: 1400px;""");

    Header();
    htmlToReturn.Write($@"
	<tr>



					<td height=""100%"" valign=""top"" >
						<div style=""text-align: center; width: 800px; align: center;"">
							<div>

								<div>

								</div>
								<br>



								<table style=""text-align: center; width: 100%"">


									<tr style=""background-color: Silver; height: 55px ; text-align: center; "">
										<td >
											<b>" + ApplicationCommon.CNV("INTESTAZIONE_ISTANZA_SDA_2") + $@"</b>
											<br>


										</td>
									</tr>

								</table>
							</div>

						</div>");
    htmlToReturn.Write(ApplicationCommon.CNV("ISTANZA_ALBO_ME_4_KEY_001").Replace("(((nomebando)))", DOC_Field("TESTATA", "nomebando")));
    htmlToReturn.Write($@"
	<div style=""width: 800px; margin-top: 15px; text-align: left"">

							<table>
								<tr>
									<td nowrap=""nowrap"">
										Il sottoscritto
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "NomeRapLeg") + $@" &nbsp; " + DOC_FieldHTML("TESTATA", "CognomeRapLeg") + $@"
										</font>
									</td>");
    htmlToReturn.Write($@"
	<td nowrap=""nowrap"">
										nato a
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "LocalitaRapLeg") + $@"
										</font>
									</td>");
    htmlToReturn.Write($@"
	<td nowrap=""nowrap"">
										Provincia
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "ProvinciaRapLeg") + $@"
										</font>
									</td>
									<td nowrap=""nowrap"">
      Stato
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "StatoRapLeg") + $@"
										</font>
									</td>
									<td nowrap=""nowrap"">
										il
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "DataRapLeg") + $@"
										</font>
									</td>
								</tr>
							</table>");
    htmlToReturn.Write($@"<table>
								<tr>

									<td nowrap=""nowrap"">
										Codice Fiscale
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "CFRapLeg") + $@"
										</font>
									</td>
									<td nowrap=""nowrap"">
										Telefono
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "TelefonoRapLeg") + $@"
										</font>
									</td>
									<td nowrap=""nowrap"">
										Telefono 2
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "CellulareRapLeg") + $@"
										</font>
									</td>


									<td nowrap=""nowrap"">
										Residente a
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "ResidenzaRapLeg") + $@"
										</font>
									</td>

								</tr>
							</table>");
    htmlToReturn.Write($@"<table>
								<tr>

									<td nowrap=""nowrap"">
										Provincia
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "ProvResidenzaRapLeg") + $@"
										</font>
									</td>
									<td nowrap=""nowrap"">
      Stato
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "StatoResidenzaRapLeg") + $@"
										</font>
									</td>
									<td nowrap=""nowrap"">
										Indirizzo
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "IndResidenzaRapLeg") + $@"
										</font>
									</td>
									<td nowrap=""nowrap"">
										Cap
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "CapResidenzaRapLeg") + $@"
										</font>
									</td>


									<td nowrap=""nowrap"">
										In qualit&agrave; di
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "RuoloRapLeg") + $@"
										</font>
									</td>

								</tr>
							</table>");
    htmlToReturn.Write($@"
	<table>
								<tr>
									<td nowrap=""nowrap"">
										Giusta procura per notaio
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "Procura") + $@"
										</font>
									</td>
									<td nowrap=""nowrap"">
										del
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "DelProcura") + $@"
										</font>
									</td>


									<td nowrap=""nowrap"">
										Numero Rep.
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "NumProcura") + $@"
										</font>
									</td>
									<td nowrap=""nowrap"">
										Raccolta Numero
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "NumRaccolta") + $@"
										</font>
									</td>
								</tr>
							</table>");
    htmlToReturn.Write($@"
	<table>
								<tr>

									<td nowrap=""nowrap"">
										Della Società
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "RagSoc") + $@"
										</font>
									</td>");
    htmlToReturn.Write($@"<!--td nowrap=""nowrap"">
	Forma Giuridica
	</td>
	<td>
	<font class=""Input"">
	" + DOC_FieldHTML("TESTATA", "NaGi") + $@"
	</font>
	</td-->");
    htmlToReturn.Write($@"
	<table>
							<table>
								<tr>

									<td nowrap=""nowrap"">
										Iscritta a
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "SedeCCIAA") + $@"
										</font>
									</td>
									<td nowrap=""nowrap"">
										con il numero:
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "IscrCCIAA") + $@"
										</font>
									</td>
							<table>
								<tr>
									<td nowrap=""nowrap"">
										Codice Fiscale
									</td>

									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "codicefiscale") + $@"
										</font>
									</td>
									<td nowrap=""nowrap"">
										P. Iva
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "PIVA") + $@"
										</font>
									</td>
								</tr>
							</table>");

    htmlToReturn.Write($@"
	<table>
								<tr>

									<td nowrap=""nowrap"">
										Con sede legale in via
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "INDIRIZZOLEG") + $@"
										</font>
									</td>
									<td nowrap=""nowrap"">
										Comune
									</td>

									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "LOCALITALEG") + $@"
										</font>
									</td>

								</tr>
							</table>");
    htmlToReturn.Write($@"
							<table>
								<tr>

									<td nowrap=""nowrap"">
										C.a.p.
									</td>

									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "CAPLEG") + $@"
										</font>
									</td>
									<td nowrap=""nowrap"">
										Provincia
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "PROVINCIALEG") + $@"
										</font>
									</td>

									<td nowrap=""nowrap"">
     Stato
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "STATOLOCALITALEG") + $@"
										</font>
									</td>
								</tr>
							</table>
							<table>
								</tr>
									<td nowrap=""nowrap"">
										Telefono <em>(1)</em>
									</td>

									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "NUMTEL") + $@"
										</font>
									</td>
									<td nowrap=""nowrap"">
										Telefono <em>(2)</em>
									</td>
									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "NUMTEL2") + $@"
										</font>
									</td>
									<td nowrap=""nowrap"">
										Fax
									</td>

									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "NUMFAX") + $@"
										</font>
									</td>

									<td nowrap=""nowrap"">
										E-mail Pec
									</td>

									<td>
										<font class=""Input"">
											" + DOC_FieldHTML("TESTATA", "EMAIL") + $@"
										</font>
									</td>

								</tr>
							</table>");

    string ISTANZA_ALBO_ME_4_KEY_002 = ApplicationCommon.CNV("ISTANZA_ALBO_ME_4_KEY_002");
    ISTANZA_ALBO_ME_4_KEY_002 = ISTANZA_ALBO_ME_4_KEY_002.Replace("(((CampoTesto_10)))", "<b>" + DOC_Field("TESTATA", "CampoTesto_10") + "</b>");
    ISTANZA_ALBO_ME_4_KEY_002 = ISTANZA_ALBO_ME_4_KEY_002.Replace("(((DataInvioGara)))", "<b>" + DOC_Field("TESTATA", "DataInvioGara") + "</b>");
    ISTANZA_ALBO_ME_4_KEY_002 = ISTANZA_ALBO_ME_4_KEY_002.Replace("(((CheckIscritta1)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA", "CheckIscritta1") == "1", "", "un") + @"checked.gif"" /></font>");
    ISTANZA_ALBO_ME_4_KEY_002 = ISTANZA_ALBO_ME_4_KEY_002.Replace("(((Registro_Camera_Provincia_Artigianato)))", "<b>" + DOC_Field("TESTATA", "Registro_Camera_Provincia_Artigianato") + "</b>");
    ISTANZA_ALBO_ME_4_KEY_002 = ISTANZA_ALBO_ME_4_KEY_002.Replace("(((Registro_Provincia_Artigianato)))", "<b>" + DOC_Field("TESTATA", "Registro_Provincia_Artigianato") + "</b>");
    ISTANZA_ALBO_ME_4_KEY_002 = ISTANZA_ALBO_ME_4_KEY_002.Replace("(((elenco_camera_attivita_artigianato)))", "<b>" + DOC_Field("TESTATA", "elenco_camera_attivita_artigianato") + "</b>");
    ISTANZA_ALBO_ME_4_KEY_002 = ISTANZA_ALBO_ME_4_KEY_002.Replace("(((numero_iscrizione)))", "<b>" + DOC_Field("TESTATA", "numero_iscrizione") + "</b>");
    ISTANZA_ALBO_ME_4_KEY_002 = ISTANZA_ALBO_ME_4_KEY_002.Replace("(((data_iscrizione)))", "<b>" + DOC_Field("TESTATA", "data_iscrizione") + "</b>");
    ISTANZA_ALBO_ME_4_KEY_002 = ISTANZA_ALBO_ME_4_KEY_002.Replace("(((NaGi)))", "<b>" + DOC_Field("TESTATA", "NaGi") + "</b>");
    ISTANZA_ALBO_ME_4_KEY_002 = ISTANZA_ALBO_ME_4_KEY_002.Replace("(((sede_iscrizione)))", "<b>" + DOC_Field("TESTATA", "sede_iscrizione") + "</b>");
    ISTANZA_ALBO_ME_4_KEY_002 = ISTANZA_ALBO_ME_4_KEY_002.Replace("(((CF_iscrizione)))", "<b>" + DOC_Field("TESTATA", "CF_iscrizione") + "</b>");
    ISTANZA_ALBO_ME_4_KEY_002 = ISTANZA_ALBO_ME_4_KEY_002.Replace("(((IVA_iscrizione)))", "<b>" + DOC_Field("TESTATA", "IVA_iscrizione") + "</b>");
    ISTANZA_ALBO_ME_4_KEY_002 = ISTANZA_ALBO_ME_4_KEY_002.Replace("(((CheckIscritta2)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA", "CheckIscritta2") == "1", "", "un") + @"checked.gif"" /></font>");
    ISTANZA_ALBO_ME_4_KEY_002 = ISTANZA_ALBO_ME_4_KEY_002.Replace("(((CheckIscritta3)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA", "CheckIscritta3") == "1", "", "un") + @"checked.gif"" /></font>");
    ISTANZA_ALBO_ME_4_KEY_002 = ISTANZA_ALBO_ME_4_KEY_002.Replace("(((CheckSoggetti1)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA", "CheckSoggetti1") == "1", "", "un") + @"checked.gif"" /></font>");
    ISTANZA_ALBO_ME_4_KEY_002 = ISTANZA_ALBO_ME_4_KEY_002.Replace("(((CheckSoggetti2)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA", "CheckSoggetti2") == "1", "", "un") + @"checked.gif"" /></font>");
    ISTANZA_ALBO_ME_4_KEY_002 = ISTANZA_ALBO_ME_4_KEY_002.Replace("(((CheckSoggetti3)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA", "CheckSoggetti3") == "1", "", "un") + @"checked.gif"" /></font>");
    ISTANZA_ALBO_ME_4_KEY_002 = ISTANZA_ALBO_ME_4_KEY_002.Replace("(((CheckSoggetti4)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA", "CheckSoggetti4") == "1", "", "un") + @"checked.gif"" /></font>");


    htmlToReturn.Write(ISTANZA_ALBO_ME_4_KEY_002);

    htmlToReturn.Write($@"
							</div>
						</div>
					</td>
				</tr>");
    footer();
    htmlToReturn.Write("</table>");
    htmlToReturn.Write($@"<!-- fine pagina 1-->");
    PrintPagina();
    htmlToReturn.Write($@"<table style=""width: 800px; height: 1400px;""");
    Header();
    htmlToReturn.Write($@"
	<tr>
		<td height=""100%"" valign=""top"">
		<div style=""text-align: left; width: 100%"">");
    int row = 0;
    row = DOC_NumRow("SOGGETTI", "");
    htmlToReturn.Write($@"
	<table style=""border: 0px solid black; border-collapse: collapse; width: 100%"" align=""center"" cellpadding=""5"">
	<tr style=""height: 18px"">
	<td style=""border: 0px solid black;"" width=""15%"">Nome</td>
	<td style=""border: 0px solid black;"" width=""15%"">Cognome</td>
	<td style=""border: 0px solid black;"" width=""15%"">Luogo</td>
	<td style=""border: 0px solid black;"" width=""15%"">Data di Nascita</td>
	<td style=""border: 0px solid black;"" width=""15%"">Codice Fiscale</td>
	<td style=""border: 0px solid black;"" width=""10%"">Carica</td>
	<td style=""border: 0px solid black;"" width=""15%"">Residenza</td>
	<td style=""border: 0px solid black;"" width=""5%"">Cessato</td>
	</tr>");
    for (int i = 0; i <= row - 1; i++)
    {
        htmlToReturn.Write($@"
		<tr style=""height: 20px"">
			<td style=""border: 0px solid black;"" width=""15%""><font class=""Input"">" + DOC_FieldRowHTML("SOGGETTI", "NomeDirTec", i) + $@"</font></td>
			<td style=""border: 0px solid black;"" width=""15%""><font class=""Input"">" + DOC_FieldRowHTML("SOGGETTI", "CognomeDirTec", i) + $@"</font></td>
			<td style=""border: 0px solid black;"" width=""15%""><font class=""Input"">" + DOC_FieldRowHTML("SOGGETTI", "LocalitaDirTec", i) + $@"</font></td>
			<td style=""border: 0px solid black;"" width=""15%""><font class=""Input"">" + DOC_FieldRowHTML("SOGGETTI", "DataDirTec", i) + $@"</font></td>
			<td style=""border: 0px solid black;"" width=""15%""><font class=""Input"">" + DOC_FieldRowHTML("SOGGETTI", "CFDirTec", i) + $@"</font></td>
			<td style=""border: 0px solid black;"" width=""10%""><font class=""Input"">" + DOC_FieldRowHTML("SOGGETTI", "RuoloDirTec", i) + $@"</font></td>
			<td style=""border: 0px solid black;"" width=""15%""><font class=""Input"">" + DOC_FieldRowHTML("SOGGETTI", "ResidenzaDirTec", i) + $@"</font></td>
			<td style=""border: 0px solid black;"" width=""5%""><font class=""Input"">" + IIF(DOC_FieldRowHTML("SOGGETTI", "Checkcessati", i) == "1", "Cessato", "") + $@"</font></td>
		 </tr>");
    }
    htmlToReturn.Write($@"
	 </table>
	 <br/>");
    string val_ISTANZA_ALBO_ME_4_KEY_003 = ApplicationCommon.CNV("ISTANZA_ALBO_ME_4_KEY_003");
    val_ISTANZA_ALBO_ME_4_KEY_003 = val_ISTANZA_ALBO_ME_4_KEY_003.Replace("(((check_art_80_1)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA2", "check_art_80_1") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_003 = val_ISTANZA_ALBO_ME_4_KEY_003.Replace("(((check_art_80_2)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA2", "check_art_80_2") == "1", "", "un") + @"checked.gif"" /></font>");

    htmlToReturn.Write(val_ISTANZA_ALBO_ME_4_KEY_003);
    htmlToReturn.Write("<br/>");
    int row_SENTENZE = 0;
    row_SENTENZE = DOC_NumRow("SENTENZE", "");

    htmlToReturn.Write($@"
	<table style=""border: 0px solid black; border-collapse: collapse; width: 100%"" align=""center"" cellpadding=""5"">
	<tr style=""height: 18px"">
	<td style=""border: 0px solid black;"" width=""25%"">Nome</td>
	<td style=""border: 0px solid black;"" width=""25%"">Cognome</td>
	<td style=""border: 0px solid black;"" width=""25%"">Codice Fiscale</td>
	<td style=""border: 0px solid black;"" width=""25%"">Sentenza Definitiva/Decreto Penale Irrevocabile/Misura Interdittiva</td>
	</tr>");
    for (int i = 0; i <= row_SENTENZE - 1; i++)
    {
        htmlToReturn.Write($@"
		<tr style=""height: 20px"">
			<td style=""border: 0px solid black;"" width=""25%""><font class=""Input"">" + DOC_FieldRowHTML("SENTENZE", "NomeDirTec", i) + $@"</font></td>
			<td style=""border: 0px solid black;"" width=""25%""><font class=""Input"">" + DOC_FieldRowHTML("SENTENZE", "CognomeDirTec", i) + $@"</font></td>
			<td style=""border: 0px solid black;"" width=""25%""><font class=""Input"">" + DOC_FieldRowHTML("SENTENZE", "CFDirTec", i) + $@"</font></td>
			<td style=""border: 0px solid black;"" width=""25%""><font class=""Input"">" + DOC_FieldRowHTML("SENTENZE", "CampoTesto_1", i) + $@"</font></td>

		 </tr>");

    }
    htmlToReturn.Write("</table>");
    string val_ISTANZA_ALBO_ME_4_KEY_004 = ApplicationCommon.CNV("ISTANZA_ALBO_ME_4_KEY_004");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((check_art_80_violazioni_1)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA3", "check_art_80_violazioni_1") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((check_art_80_violazioni_2)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA3", "check_art_80_violazioni_2") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((check_art_80_infrazioni_1)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA3", "check_art_80_infrazioni_1") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((check_art_80_infrazioni_2)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA3", "check_art_80_infrazioni_2") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((check_art_80_fallimento_1)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA3", "check_art_80_fallimento_1") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((check_art_80_fallimento_2)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA3", "check_art_80_fallimento_2") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((check_art_80_fallimento_3)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA3", "check_art_80_fallimento_3") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((check_art_80_fallimento_4)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA3", "check_art_80_fallimento_4") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((check_art_80_fallimento_5)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA3", "check_art_80_fallimento_5") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((check_art_80_fallimento_6)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA3", "check_art_80_fallimento_6") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((Tribunale_Chk_fall_2)))", "<b>" + DOC_Field("TESTATA3", "Tribunale_Chk_fall_2") + "</b>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((Provvedimento_Chk_fall_2)))", "<b>" + DOC_Field("TESTATA3", "Provvedimento_Chk_fall_2") + "</b>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((del_Chk_fall_2)))", "<b>" + DOC_Field("TESTATA3", "del_Chk_fall_2") + "</b>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((Tribunale_Chk_fall_3)))", "<b>" + DOC_Field("TESTATA3", "Tribunale_Chk_fall_3") + "</b>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((Provvedimento_Chk_fall_3)))", "<b>" + DOC_Field("TESTATA3", "Provvedimento_Chk_fall_3") + "</b>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((del_Chk_fall_3)))", "<b>" + DOC_Field("TESTATA3", "del_Chk_fall_3") + "</b>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((Tribunale_Chk_fall_3_2)))", "<b>" + DOC_Field("TESTATA3", "Tribunale_Chk_fall_3_2") + "</b>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((Provvedimento_Chk_fall_3_2)))", "<b>" + DOC_Field("TESTATA3", "Provvedimento_Chk_fall_3_2") + "</b>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((del_Chk_fall_3_2)))", "<b>" + DOC_Field("TESTATA3", "del_Chk_fall_3_2") + "</b>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((Tribunale_Chk_fall_4)))", "<b>" + DOC_Field("TESTATA3", "Tribunale_Chk_fall_4") + "</b>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((Provvedimento_Chk_fall_4)))", "<b>" + DOC_Field("TESTATA3", "Provvedimento_Chk_fall_4") + "</b>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((del_Chk_fall_4)))", "<b>" + DOC_Field("TESTATA3", "del_Chk_fall_4") + "</b>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((Tribunale_Chk_fall_4_2)))", "<b>" + DOC_Field("TESTATA3", "Tribunale_Chk_fall_4_2") + "</b>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((Provvedimento_Chk_fall_4_2)))", "<b>" + DOC_Field("TESTATA3", "Provvedimento_Chk_fall_4_2") + "</b>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((del_Chk_fall_4_2)))", "<b>" + DOC_Field("TESTATA3", "del_Chk_fall_4_2") + "</b>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((check_art_80_illeciti_1)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA3", "check_art_80_illeciti_1") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((check_art_80_illeciti_2)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA3", "check_art_80_illeciti_2") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_004 = val_ISTANZA_ALBO_ME_4_KEY_004.Replace("(((check_art_80_illeciti_3)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA3", "check_art_80_illeciti_3") == "1", "", "un") + @"checked.gif"" /></font>");

    int fine = InStrVb6(1, val_ISTANZA_ALBO_ME_4_KEY_004, "<strong>e)</strong>");
    htmlToReturn.Write(MidVb6(val_ISTANZA_ALBO_ME_4_KEY_004, 1, fine - 1));
    htmlToReturn.Write($@"
			</div>
			</div>
		</td>
	</tr>");
    footer();
    htmlToReturn.Write("</table>");
    htmlToReturn.Write($@"<!-- fine pagina 2-->");
    PrintPagina();
    htmlToReturn.Write($@"<table style=""width: 800px; height: 1400px;""");
    Header();
    htmlToReturn.Write($@"
	<tr>
			<td height=""100%"" valign=""top"">
				<div style=""text-align: left; width: 100%"">
				<div>");
    int start = InStrVb6(1, val_ISTANZA_ALBO_ME_4_KEY_004, "<strong>e)</strong>");
    fine = InStrVb6(1, val_ISTANZA_ALBO_ME_4_KEY_004, "<strong>h)</strong>");
    //'response.write "fine"  &fine
    htmlToReturn.Write(MidVb6(val_ISTANZA_ALBO_ME_4_KEY_004, start, fine - start));
    htmlToReturn.Write($@"
							</div>
							</div>
						</td>
					</tr>");
    footer();
    htmlToReturn.Write("</table>");
    htmlToReturn.Write($@"<!-- fine pagina 3-->");
    htmlToReturn.Write($@"<!-- fine pagina 2-->");
    PrintPagina();
    htmlToReturn.Write($@"<table style=""width: 800px; height: 1400px;""");
    Header();
    htmlToReturn.Write($@"
	<tr>
			<td height=""100%"" valign=""top"">
				<div style=""text-align: left; width: 100%"">
						<div>");
    start = InStrVb6(1, val_ISTANZA_ALBO_ME_4_KEY_004, "<strong>h)</strong>");
    htmlToReturn.Write(MidVb6(val_ISTANZA_ALBO_ME_4_KEY_004, start));

    int row_CONDANNE = 0;
    row_SENTENZE = DOC_NumRow("CONDANNE", "");
    htmlToReturn.Write($@"
	<table style=""border: 0px solid black; border-collapse: collapse; width: 100%"" align=""center"" cellpadding=""5"">
		<tr style=""height: 18px"">
		<td style=""border: 0px solid black;"" width=""25%"">Nome</td>
		<td style=""border: 0px solid black;"" width=""25%"">Cognome</td>
		<td style=""border: 0px solid black;"" width=""25%"">Codice Fiscale</td>
		 <td style=""border: 0px solid black;"" width=""25%"">Condanne NON Passate In Giudicato (Specificare)</td>
	</tr>");
    for (int i = 0; i <= row_CONDANNE - 1; i++)
    {
        htmlToReturn.Write($@"
		<tr style=""height: 20px"">
			<td style=""border: 0px solid black;"" width=""25%""><font class=""Input"">" + DOC_FieldRowHTML("CONDANNE", "NomeDirTec", i) + $@"</font></td>
			<td style=""border: 0px solid black;"" width=""25%""><font class=""Input"">" + DOC_FieldRowHTML("CONDANNE", "CognomeDirTec", i) + $@"</font></td>
			<td style=""border: 0px solid black;"" width=""25%""><font class=""Input"">" + DOC_FieldRowHTML("CONDANNE", "CFDirTec", i) + $@"</font></td>
			<td style=""border: 0px solid black;"" width=""25%""><font class=""Input"">" + DOC_FieldRowHTML("CONDANNE", "CampoTesto_2", i) + $@"</font></td>

		 </tr>");
    }
    htmlToReturn.Write($@"
	</table>

	<br/><br/>");
    string val_ISTANZA_ALBO_ME_4_KEY_005 = ApplicationCommon.CNV("ISTANZA_ALBO_ME_4_KEY_005");
    val_ISTANZA_ALBO_ME_4_KEY_005 = val_ISTANZA_ALBO_ME_4_KEY_005.Replace($@"(((check_art_80_fiduciaria_1)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA4", "check_art_80_fiduciaria_1") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_005 = val_ISTANZA_ALBO_ME_4_KEY_005.Replace($@"(((check_art_80_fiduciaria_2)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA4", "check_art_80_fiduciaria_2") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_005 = val_ISTANZA_ALBO_ME_4_KEY_005.Replace($@"(((check_art_80_assunzioni_1)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA4", "check_art_80_assunzioni_1") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_005 = val_ISTANZA_ALBO_ME_4_KEY_005.Replace($@"(((check_art_80_assunzioni_2)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA4", "check_art_80_assunzioni_2") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_005 = val_ISTANZA_ALBO_ME_4_KEY_005.Replace($@"(((check_art_80_vittime_1)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA4", "check_art_80_vittime_1") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_005 = val_ISTANZA_ALBO_ME_4_KEY_005.Replace($@"(((check_art_80_vittime_2)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA4", "check_art_80_vittime_2") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_005 = val_ISTANZA_ALBO_ME_4_KEY_005.Replace($@"(((check_art_80_vittime_3)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA4", "check_art_80_vittime_3") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_005 = val_ISTANZA_ALBO_ME_4_KEY_005.Replace($@"(((check_art_80_Dichiarazione)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA4", "check_art_80_Dichiarazione") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_005 = val_ISTANZA_ALBO_ME_4_KEY_005.Replace($@"(((check_art_80_Dichiarazione2)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA4", "check_art_80_Dichiarazione2") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_005 = val_ISTANZA_ALBO_ME_4_KEY_005.Replace($@"(((check_blacklist_1)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA4", "check_blacklist_1") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_005 = val_ISTANZA_ALBO_ME_4_KEY_005.Replace($@"(((check_blacklist_2)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA4", "check_blacklist_2") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_005 = val_ISTANZA_ALBO_ME_4_KEY_005.Replace($@"(((check_art_80_Dichiarazione2)))", $@"<font class=""Input""><img src=""../ctl_library/images/domain/" + IIF(DOC_Field("TESTATA4", "check_art_80_Dichiarazione2") == "1", "", "un") + @"checked.gif"" /></font>");
    val_ISTANZA_ALBO_ME_4_KEY_005 = val_ISTANZA_ALBO_ME_4_KEY_005.Replace($@"(((testo_check_dichiarazione)))", "<b>" + DOC_Field("TESTATA4", "testo_check_dichiarazione") + "</b>");


    val_ISTANZA_ALBO_ME_4_KEY_005 = val_ISTANZA_ALBO_ME_4_KEY_005.Replace("(((sede_disabili)))", "<b>" + DOC_Field("TESTATA4", "sede_disabili") + "</b>");
    val_ISTANZA_ALBO_ME_4_KEY_005 = val_ISTANZA_ALBO_ME_4_KEY_005.Replace("(((indirizzo_disabili)))", "<b>" + DOC_Field("TESTATA4", "indirizzo_disabili") + "</b>");
    val_ISTANZA_ALBO_ME_4_KEY_005 = val_ISTANZA_ALBO_ME_4_KEY_005.Replace("(((PEC_disabili)))", "<b>" + DOC_Field("TESTATA4", "PEC_disabili") + "</b>");
    val_ISTANZA_ALBO_ME_4_KEY_005 = val_ISTANZA_ALBO_ME_4_KEY_005.Replace("(((SedeEntrate)))", "<b>" + DOC_Field("TESTATA4", "SedeEntrate") + "</b>");
    val_ISTANZA_ALBO_ME_4_KEY_005 = val_ISTANZA_ALBO_ME_4_KEY_005.Replace("(((IndirizzoEntrate)))", "<b>" + DOC_Field("TESTATA4", "IndirizzoEntrate") + "</b>");
    val_ISTANZA_ALBO_ME_4_KEY_005 = val_ISTANZA_ALBO_ME_4_KEY_005.Replace("(((PEC_Entrate)))", "<b>" + DOC_Field("TESTATA4", "PEC_Entrate") + "</b>");
    val_ISTANZA_ALBO_ME_4_KEY_005 = val_ISTANZA_ALBO_ME_4_KEY_005.Replace("(((Province_Dove_Opera)))", "<b>" + getProvincia(DOC_FieldTecnical("TESTATA4", "Province_Dove_Opera")) + "</b>");
    val_ISTANZA_ALBO_ME_4_KEY_005 = val_ISTANZA_ALBO_ME_4_KEY_005.Replace("(((Tempi_Medi_gg_consegna)))", "<b>" + DOC_Field("TESTATA4", "Tempi_Medi_gg_consegna") + "</b>");
    val_ISTANZA_ALBO_ME_4_KEY_005 = val_ISTANZA_ALBO_ME_4_KEY_005.Replace("(((Fatturato_ultimo_anno)))", "<b>" + DOC_Field("TESTATA4", "Fatturato_ultimo_anno") + "</b>");



    fine = InStrVb6(1, val_ISTANZA_ALBO_ME_4_KEY_005, "<strong>n)</strong>");
    htmlToReturn.Write(MidVb6(val_ISTANZA_ALBO_ME_4_KEY_005, 1, fine - 1));

    htmlToReturn.Write($@"
								</div>
							</div>
						</td>
					</tr>");
    footer();
    htmlToReturn.Write("</table>");
    htmlToReturn.Write($@"<!-- fine pagina 4-->");
    PrintPagina();
    htmlToReturn.Write($@"<table style=""width: 800px; height: 1400px;""");
    Header();
    htmlToReturn.Write($@"
	<tr>
	<td height=""100%"" valign=""top"">
	<div style=""text-align: left; width: 100%"">
	<div>");
    start = InStrVb6(1, val_ISTANZA_ALBO_ME_4_KEY_005, "<strong>n)</strong>");
    fine = InStrVb6(1, val_ISTANZA_ALBO_ME_4_KEY_005, "<strong>v)</strong>");
    htmlToReturn.Write(Strings.Mid(val_ISTANZA_ALBO_ME_4_KEY_005, start, fine - start));
    htmlToReturn.Write($@"
							</div>
							</div>
						</td>
					</tr>");
    footer();
    htmlToReturn.Write("</table>");
    htmlToReturn.Write($@"<!-- fine pagina 4-->");

    htmlToReturn.Write($@"<!-- fine pagina 4-->");
    PrintPagina();
    htmlToReturn.Write($@"<table style=""width: 800px; height: 1400px;""");
    Header();
    htmlToReturn.Write($@"
	<tr>
			<td height=""100%"" valign=""top"">
							<div style=""text-align: left; width: 100%"">
								<div>");
    start = InStrVb6(1, val_ISTANZA_ALBO_ME_4_KEY_005, "<strong>v)</strong>");
    htmlToReturn.Write(MidVb6(val_ISTANZA_ALBO_ME_4_KEY_005, start));
    htmlToReturn.Write($@"<strong>" + ApplicationCommon.CNV("ISTANZA_ALBO_ME_4_KEY_006") + $@"</strong></br>");
    string stringa = "";
    string[] arr = null;
    stringa = DOC_FieldTecnical("DISPLAY_CLASSI", "ClasseIscriz");
    arr = stringa.Split("###");
    for (int i = 1; i <= arr.Length - 1; i++)
    {
        htmlToReturn.Write($@"<br><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;" + getClasseIscrizione(arr[i]) + $@"</b>");
    }
    htmlToReturn.Write($@"
	<p><strong>Nota Bene.</strong> La documentazione aggiuntiva allegata dal concorrente, come richiesto ai punti precedenti deve essere denominata secondo la seguente regola: <em>""identificativo gara – ragione sociale del partecipante - punto della domanda di partecipazione cui la documentazione fa riferimento</em>.</p>

	<h3 style=""text-align:center""> ULTERIORE DOCUMENTAZIONE </h3>
	<br/>");
    int row6 = 0;
    row6 = DOC_NumRow("DOCUMENTAZIONE", "");
    htmlToReturn.Write($@"
	<table style=""border: 0px solid black; border-collapse: collapse; width: 80%"" align=""center"" cellpadding=""5"">
	<tr style=""height: 18px"">
	<td style=""border: 0px solid black;"" width=""40%"">Descrizione</td>
	<td style=""border: 0px solid black;"" width=""40%"">Allegato</td>
	</tr>");
    for (int i = 0; i <= row6 - 1; i++)
    {
        htmlToReturn.Write($@"
		  <tr style=""height: 20px"">
				<td style=""border: 0px solid black;"" width=""20%""><font class=""Input"">" + DOC_FieldRow("DOCUMENTAZIONE", "Descrizione", i) + $@"</font></td>
				<td style=""border: 0px solid black;"" width=""20%""><font class=""Input"">" + DOC_FieldRow("DOCUMENTAZIONE", "Allegato", i) + $@"</font></td>
			 </tr>");
    }
    htmlToReturn.Write($@"
								</table>

								</div>
							</div>
						</td>
					</tr>");
    footer();
    htmlToReturn.Write($@"
	</table>

	</center>

	</body>
	</html>");
    void PrintPagina()
    {
        htmlToReturn.Write($@"<div style=""page-break-after: always""></div>");
    }
    void footerold()
    {
        NumPag = NumPag + 1;
        htmlToReturn.Write($@"
		<br />

		<hr />
		<table width=""720px"" style=""vertical-align: bottom; bottom: 0px"">
			<tr>
				<td valign=""bottom"" align=""right"">
					<br>
					" + NumPag + $@"
				</td>
			</tr>
		</table>");
    }
    void Header()
    {
        if (DOC_FieldTecnical("DOCUMENT", "StatoDoc") == "Annullato")
        {
            htmlToReturn.Write($@" style=""background-image:url(../images/annullato.gif) ; background-repeat:no-repeat;"" >");
        }
        else
        {
            htmlToReturn.Write(">");
        }
        htmlToReturn.Write($@"<tr><td height=""50px"" align=""center"" valign=""top"" >");
        string imgHeader = ApplicationCommon.CNV("HEADER_STAMPE");
        if (imgHeader.Contains("???", StringComparison.Ordinal))
        {
            htmlToReturn.Write($@"<img height=""50px"" src=""logo_new.gif"" border=""0"" alt=""" + ApplicationCommon.CNV("ALT LOGO") + @"""/>");
        }
        else
        {
            htmlToReturn.Write(imgHeader);
        }
        htmlToReturn.Write("</td></tr>");
    }
    //'------------------------------------------------------------------------------
    //'-- funzione per disegnare il pie pagina
    //'------------------------------------------------------------------------------
    void footer()
    {
        NumPag = NumPag + 1;

        htmlToReturn.Write($@"<tr><td valign=""bottom"" height=""10px"" >");
        htmlToReturn.Write($@"<table width=""720px"" height=""10px"" style=""vertical-align: bottom; bottom: 0px""> ");
        htmlToReturn.Write($@"        <tr><td align=""left"" style=""border-bottom: 1px solid black;"" ><b>" + ApplicationCommon.CNV("ISTANZA_ALBO_ME_4_KEY_FOOTER") + "</b></td></tr><tr>");
        htmlToReturn.Write($@"            <td valign=""bottom"" align=""right"" >");
        htmlToReturn.Write("                ");
        htmlToReturn.Write("                  <br>");
        htmlToReturn.Write("                " + NumPag);
        htmlToReturn.Write("            </td>");
        htmlToReturn.Write("        </tr>");
        htmlToReturn.Write("    </table>");
        htmlToReturn.Write("    </td></tr>");
    }
    //'-- Testo aggiunto in automatico per liberare la memoria dei nuovi report
    try
    {
        FreeMemDocument(session);
    }
    catch
    {

    }
}@Html.Raw(htmlToReturn.Out())